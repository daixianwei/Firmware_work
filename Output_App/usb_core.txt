; generated by ARM C/C++ Compiler, 4.1 [Build 894]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\Output_App\usb_core.o --asm_dir=..\Output_App\ --list_dir=..\Output_App\ --depend=..\Output_App\usb_core.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=870 -I.\System\CM3 -I.\System\FWlib\inc -I.\System\Startup -I.\ISR -I.\Main -I.\Management\DisplayDriver -I.\Management\HumanInput -I.\Management\Interface -I.\Management\RotationMotor -I.\Management\ScanMotor -I.\Management\Common_CRC -I.\Management\QRCode -I.\Management\SystemManage_RTC -I.\Management\SignalProcess_Sample -I.\USB -I.\USB\comm -I.\USB\lib -I.\USB\src -I.\USB\USB_Communication -ID:\Keil4.0\ARM\RV31\Inc -ID:\Keil4.0\ARM\CMSIS\Include -ID:\Keil4.0\ARM\Inc\ST\STM32F10x -D__MICROLIB -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DUSE_STM3210E_EVAL -W --omf_browse=..\Output_App\usb_core.crf USB\lib\usb_core.c]
                          THUMB

                          AREA ||i.DataStageIn||, CODE, READONLY, ALIGN=2

                  DataStageIn PROC
;;;499    *******************************************************************************/
;;;500    void DataStageIn(void)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;501    {
;;;502      ENDPOINT_INFO *pEPinfo = &pInformation->Ctrl_Info;
000004  4828              LDR      r0,|L1.168|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  f1000510          ADD      r5,r0,#0x10
;;;503      uint32_t save_wLength = pEPinfo->Usb_wLength;
00000c  882e              LDRH     r6,[r5,#0]
;;;504      uint32_t ControlState = pInformation->ControlState;
00000e  4826              LDR      r0,|L1.168|
000010  6800              LDR      r0,[r0,#0]  ; pInformation
000012  7a07              LDRB     r7,[r0,#8]
;;;505    
;;;506      uint8_t *DataBuffer;
;;;507      uint32_t Length;
;;;508    
;;;509      if ((save_wLength == 0) && (ControlState == LAST_IN_DATA))
000014  b9d6              CBNZ     r6,|L1.76|
000016  2f04              CMP      r7,#4
000018  d118              BNE      |L1.76|
;;;510      {
;;;511        if(Data_Mul_MaxPacketSize == TRUE)
00001a  4824              LDR      r0,|L1.172|
00001c  7800              LDRB     r0,[r0,#0]  ; Data_Mul_MaxPacketSize
00001e  2801              CMP      r0,#1
000020  d10f              BNE      |L1.66|
;;;512        {
;;;513          /* No more data to send and empty packet */
;;;514          Send0LengthData();
000022  2100              MOVS     r1,#0
000024  4822              LDR      r0,|L1.176|
000026  6800              LDR      r0,[r0,#0]
000028  b280              UXTH     r0,r0
00002a  1c80              ADDS     r0,r0,#2
00002c  4a21              LDR      r2,|L1.180|
00002e  f8421010          STR      r1,[r2,r0,LSL #1]
000032  2030              MOVS     r0,#0x30
000034  4920              LDR      r1,|L1.184|
000036  8008              STRH     r0,[r1,#0]
;;;515          ControlState = LAST_IN_DATA;
000038  bf00              NOP      
;;;516          Data_Mul_MaxPacketSize = FALSE;
00003a  2000              MOVS     r0,#0
00003c  491b              LDR      r1,|L1.172|
00003e  7008              STRB     r0,[r1,#0]
000040  e003              B        |L1.74|
                  |L1.66|
;;;517        }
;;;518        else 
;;;519        {
;;;520          /* No more data to send so STALL the TX Status*/
;;;521          ControlState = WAIT_STATUS_OUT;
000042  2707              MOVS     r7,#7
;;;522          vSetEPTxStatus(EP_TX_STALL);
000044  2010              MOVS     r0,#0x10
000046  491c              LDR      r1,|L1.184|
000048  8008              STRH     r0,[r1,#0]
                  |L1.74|
;;;523     
;;;524        }
;;;525        
;;;526        goto Expect_Status_Out;
00004a  e027              B        |L1.156|
                  |L1.76|
;;;527      }
;;;528    
;;;529      Length = pEPinfo->PacketSize;
00004c  88ac              LDRH     r4,[r5,#4]
;;;530      ControlState = (save_wLength <= Length) ? LAST_IN_DATA : IN_DATA;
00004e  42a6              CMP      r6,r4
000050  d801              BHI      |L1.86|
000052  2004              MOVS     r0,#4
000054  e000              B        |L1.88|
                  |L1.86|
000056  2002              MOVS     r0,#2
                  |L1.88|
000058  4607              MOV      r7,r0
;;;531    
;;;532      if (Length > save_wLength)
00005a  42b4              CMP      r4,r6
00005c  d900              BLS      |L1.96|
;;;533      {
;;;534        Length = save_wLength;
00005e  4634              MOV      r4,r6
                  |L1.96|
;;;535      }
;;;536    
;;;537      DataBuffer = (*pEPinfo->CopyData)(Length);
000060  b2a0              UXTH     r0,r4
000062  68a9              LDR      r1,[r5,#8]
000064  4788              BLX      r1
000066  4680              MOV      r8,r0
;;;538      
;;;539      UserToPMABufferCopy(DataBuffer, GetEPTxAddr(ENDP0), Length);
000068  2000              MOVS     r0,#0
00006a  f7fffffe          BL       GetEPTxAddr
00006e  4681              MOV      r9,r0
000070  b2a2              UXTH     r2,r4
000072  4649              MOV      r1,r9
000074  4640              MOV      r0,r8
000076  f7fffffe          BL       UserToPMABufferCopy
;;;540    
;;;541      SetEPTxCount(ENDP0, Length);
00007a  b2a1              UXTH     r1,r4
00007c  2000              MOVS     r0,#0
00007e  f7fffffe          BL       SetEPTxCount
;;;542    
;;;543      pEPinfo->Usb_wLength -= Length;
000082  8828              LDRH     r0,[r5,#0]
000084  1b00              SUBS     r0,r0,r4
000086  8028              STRH     r0,[r5,#0]
;;;544      pEPinfo->Usb_wOffset += Length;
000088  8868              LDRH     r0,[r5,#2]
00008a  4420              ADD      r0,r0,r4
00008c  8068              STRH     r0,[r5,#2]
;;;545      vSetEPTxStatus(EP_TX_VALID);
00008e  2030              MOVS     r0,#0x30
000090  4909              LDR      r1,|L1.184|
000092  8008              STRH     r0,[r1,#0]
;;;546    
;;;547      USB_StatusOut();/* Expect the host to abort the data IN stage */
000094  0200              LSLS     r0,r0,#8
000096  4909              LDR      r1,|L1.188|
000098  8008              STRH     r0,[r1,#0]
;;;548    
;;;549    Expect_Status_Out:
00009a  bf00              NOP      
                  |L1.156|
;;;550      pInformation->ControlState = ControlState;
00009c  4902              LDR      r1,|L1.168|
00009e  6809              LDR      r1,[r1,#0]  ; pInformation
0000a0  720f              STRB     r7,[r1,#8]
;;;551    }
0000a2  e8bd87f0          POP      {r4-r10,pc}
;;;552    
                          ENDP

0000a6  0000              DCW      0x0000
                  |L1.168|
                          DCD      pInformation
                  |L1.172|
                          DCD      Data_Mul_MaxPacketSize
                  |L1.176|
                          DCD      0x40005c50
                  |L1.180|
                          DCD      0x40006000
                  |L1.184|
                          DCD      SaveTState
                  |L1.188|
                          DCD      SaveRState

                          AREA ||i.DataStageOut||, CODE, READONLY, ALIGN=2

                  DataStageOut PROC
;;;442    *******************************************************************************/
;;;443    void DataStageOut(void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;444    {
;;;445      ENDPOINT_INFO *pEPinfo = &pInformation->Ctrl_Info;
000004  4828              LDR      r0,|L2.168|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  f1000410          ADD      r4,r0,#0x10
;;;446      uint32_t save_rLength;
;;;447    
;;;448      save_rLength = pEPinfo->Usb_rLength;
00000c  8826              LDRH     r6,[r4,#0]
;;;449    
;;;450      if (pEPinfo->CopyData && save_rLength)
00000e  68a0              LDR      r0,[r4,#8]
000010  b1c0              CBZ      r0,|L2.68|
000012  b1be              CBZ      r6,|L2.68|
;;;451      {
;;;452        uint8_t *Buffer;
;;;453        uint32_t Length;
;;;454    
;;;455        Length = pEPinfo->PacketSize;
000014  88a5              LDRH     r5,[r4,#4]
;;;456        if (Length > save_rLength)
000016  42b5              CMP      r5,r6
000018  d900              BLS      |L2.28|
;;;457        {
;;;458          Length = save_rLength;
00001a  4635              MOV      r5,r6
                  |L2.28|
;;;459        }
;;;460    
;;;461        Buffer = (*pEPinfo->CopyData)(Length);
00001c  b2a8              UXTH     r0,r5
00001e  68a1              LDR      r1,[r4,#8]
000020  4788              BLX      r1
000022  4607              MOV      r7,r0
;;;462        pEPinfo->Usb_rLength -= Length;
000024  8820              LDRH     r0,[r4,#0]
000026  1b40              SUBS     r0,r0,r5
000028  8020              STRH     r0,[r4,#0]
;;;463        pEPinfo->Usb_rOffset += Length;
00002a  8860              LDRH     r0,[r4,#2]
00002c  4428              ADD      r0,r0,r5
00002e  8060              STRH     r0,[r4,#2]
;;;464        PMAToUserBufferCopy(Buffer, GetEPRxAddr(ENDP0), Length);
000030  2000              MOVS     r0,#0
000032  f7fffffe          BL       GetEPRxAddr
000036  4680              MOV      r8,r0
000038  b2aa              UXTH     r2,r5
00003a  4641              MOV      r1,r8
00003c  4638              MOV      r0,r7
00003e  f7fffffe          BL       PMAToUserBufferCopy
;;;465    
;;;466      }
000042  bf00              NOP      
                  |L2.68|
;;;467    
;;;468      if (pEPinfo->Usb_rLength != 0)
000044  8820              LDRH     r0,[r4,#0]
000046  b150              CBZ      r0,|L2.94|
;;;469      {
;;;470        vSetEPRxStatus(EP_RX_VALID);/* re-enable for next data reception */
000048  f44f5040          MOV      r0,#0x3000
00004c  4917              LDR      r1,|L2.172|
00004e  8008              STRH     r0,[r1,#0]
;;;471        SetEPTxCount(ENDP0, 0);
000050  2100              MOVS     r1,#0
000052  4608              MOV      r0,r1
000054  f7fffffe          BL       SetEPTxCount
;;;472        vSetEPTxStatus(EP_TX_VALID);/* Expect the host to abort the data OUT stage */
000058  2030              MOVS     r0,#0x30
00005a  4915              LDR      r1,|L2.176|
00005c  8008              STRH     r0,[r1,#0]
                  |L2.94|
;;;473      }
;;;474      /* Set the next State*/
;;;475      if (pEPinfo->Usb_rLength >= pEPinfo->PacketSize)
00005e  8820              LDRH     r0,[r4,#0]
000060  88a1              LDRH     r1,[r4,#4]
000062  4288              CMP      r0,r1
000064  db04              BLT      |L2.112|
;;;476      {
;;;477        pInformation->ControlState = OUT_DATA;
000066  2003              MOVS     r0,#3
000068  490f              LDR      r1,|L2.168|
00006a  6809              LDR      r1,[r1,#0]  ; pInformation
00006c  7208              STRB     r0,[r1,#8]
00006e  e018              B        |L2.162|
                  |L2.112|
;;;478      }
;;;479      else
;;;480      {
;;;481        if (pEPinfo->Usb_rLength > 0)
000070  8820              LDRH     r0,[r4,#0]
000072  2800              CMP      r0,#0
000074  dd04              BLE      |L2.128|
;;;482        {
;;;483          pInformation->ControlState = LAST_OUT_DATA;
000076  2005              MOVS     r0,#5
000078  490b              LDR      r1,|L2.168|
00007a  6809              LDR      r1,[r1,#0]  ; pInformation
00007c  7208              STRB     r0,[r1,#8]
00007e  e010              B        |L2.162|
                  |L2.128|
;;;484        }
;;;485        else if (pEPinfo->Usb_rLength == 0)
000080  8820              LDRH     r0,[r4,#0]
000082  b970              CBNZ     r0,|L2.162|
;;;486        {
;;;487          pInformation->ControlState = WAIT_STATUS_IN;
000084  2006              MOVS     r0,#6
000086  4908              LDR      r1,|L2.168|
000088  6809              LDR      r1,[r1,#0]  ; pInformation
00008a  7208              STRB     r0,[r1,#8]
;;;488          USB_StatusIn();
00008c  2100              MOVS     r1,#0
00008e  4809              LDR      r0,|L2.180|
000090  6800              LDR      r0,[r0,#0]
000092  b280              UXTH     r0,r0
000094  1c80              ADDS     r0,r0,#2
000096  4a08              LDR      r2,|L2.184|
000098  f8421010          STR      r1,[r2,r0,LSL #1]
00009c  2030              MOVS     r0,#0x30
00009e  4904              LDR      r1,|L2.176|
0000a0  8008              STRH     r0,[r1,#0]
                  |L2.162|
;;;489        }
;;;490      }
;;;491    }
0000a2  e8bd81f0          POP      {r4-r8,pc}
;;;492    
                          ENDP

0000a6  0000              DCW      0x0000
                  |L2.168|
                          DCD      pInformation
                  |L2.172|
                          DCD      SaveRState
                  |L2.176|
                          DCD      SaveTState
                  |L2.180|
                          DCD      0x40005c50
                  |L2.184|
                          DCD      0x40006000

                          AREA ||i.Data_Setup0||, CODE, READONLY, ALIGN=2

                  Data_Setup0 PROC
;;;682    *******************************************************************************/
;;;683    void Data_Setup0(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;684    {
;;;685      uint8_t *(*CopyRoutine)(uint16_t);
;;;686      RESULT Result;
;;;687      uint32_t Request_No = pInformation->USBbRequest;
000004  4898              LDR      r0,|L3.616|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  7845              LDRB     r5,[r0,#1]
;;;688    
;;;689      uint32_t Related_Endpoint, Reserved;
;;;690      uint32_t wOffset, Status;
;;;691    
;;;692    
;;;693    
;;;694      CopyRoutine = NULL;
00000a  2700              MOVS     r7,#0
;;;695      wOffset = 0;
00000c  46ba              MOV      r10,r7
;;;696    
;;;697      /*GET DESCRIPTOR*/
;;;698      if (Request_No == GET_DESCRIPTOR)
00000e  2d06              CMP      r5,#6
000010  d11a              BNE      |L3.72|
;;;699      {
;;;700        if (Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT))
000012  4895              LDR      r0,|L3.616|
000014  6800              LDR      r0,[r0,#0]  ; pInformation
000016  7800              LDRB     r0,[r0,#0]
000018  f0100f7f          TST      r0,#0x7f
00001c  d113              BNE      |L3.70|
;;;701        {
;;;702          uint8_t wValue1 = pInformation->USBwValue1;
00001e  4992              LDR      r1,|L3.616|
000020  6809              LDR      r1,[r1,#0]  ; pInformation
000022  7888              LDRB     r0,[r1,#2]
;;;703          if (wValue1 == DEVICE_DESCRIPTOR)
000024  2801              CMP      r0,#1
000026  d103              BNE      |L3.48|
;;;704          {
;;;705            CopyRoutine = pProperty->GetDeviceDescriptor;
000028  4990              LDR      r1,|L3.620|
00002a  6809              LDR      r1,[r1,#0]  ; pProperty
00002c  69cf              LDR      r7,[r1,#0x1c]
00002e  e00a              B        |L3.70|
                  |L3.48|
;;;706          }
;;;707          else if (wValue1 == CONFIG_DESCRIPTOR)
000030  2802              CMP      r0,#2
000032  d103              BNE      |L3.60|
;;;708          {
;;;709            CopyRoutine = pProperty->GetConfigDescriptor;
000034  498d              LDR      r1,|L3.620|
000036  6809              LDR      r1,[r1,#0]  ; pProperty
000038  6a0f              LDR      r7,[r1,#0x20]
00003a  e004              B        |L3.70|
                  |L3.60|
;;;710          }
;;;711          else if (wValue1 == STRING_DESCRIPTOR)
00003c  2803              CMP      r0,#3
00003e  d102              BNE      |L3.70|
;;;712          {
;;;713            CopyRoutine = pProperty->GetStringDescriptor;
000040  498a              LDR      r1,|L3.620|
000042  6809              LDR      r1,[r1,#0]  ; pProperty
000044  6a4f              LDR      r7,[r1,#0x24]
                  |L3.70|
;;;714          }  /* End of GET_DESCRIPTOR */
;;;715        }
000046  e090              B        |L3.362|
                  |L3.72|
;;;716      }
;;;717    
;;;718      /*GET STATUS*/
;;;719      else if ((Request_No == GET_STATUS) && (pInformation->USBwValue == 0)
000048  2d00              CMP      r5,#0
00004a  d160              BNE      |L3.270|
00004c  4886              LDR      r0,|L3.616|
00004e  6800              LDR      r0,[r0,#0]  ; pInformation
000050  8840              LDRH     r0,[r0,#2]
000052  2800              CMP      r0,#0
000054  d15b              BNE      |L3.270|
;;;720               && (pInformation->USBwLength == 0x0002)
000056  4884              LDR      r0,|L3.616|
000058  6800              LDR      r0,[r0,#0]  ; pInformation
00005a  88c0              LDRH     r0,[r0,#6]
00005c  2802              CMP      r0,#2
00005e  d156              BNE      |L3.270|
;;;721               && (pInformation->USBwIndex1 == 0))
000060  4881              LDR      r0,|L3.616|
000062  6800              LDR      r0,[r0,#0]  ; pInformation
000064  7900              LDRB     r0,[r0,#4]
000066  2800              CMP      r0,#0
000068  d151              BNE      |L3.270|
;;;722      {
;;;723        /* GET STATUS for Device*/
;;;724        if ((Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT))
00006a  487f              LDR      r0,|L3.616|
00006c  6800              LDR      r0,[r0,#0]  ; pInformation
00006e  7800              LDRB     r0,[r0,#0]
000070  f0100f7f          TST      r0,#0x7f
000074  d105              BNE      |L3.130|
;;;725            && (pInformation->USBwIndex == 0))
000076  487c              LDR      r0,|L3.616|
000078  6800              LDR      r0,[r0,#0]  ; pInformation
00007a  8880              LDRH     r0,[r0,#4]
00007c  b908              CBNZ     r0,|L3.130|
;;;726        {
;;;727          CopyRoutine = Standard_GetStatus;
00007e  4f7c              LDR      r7,|L3.624|
000080  e073              B        |L3.362|
                  |L3.130|
;;;728        }
;;;729    
;;;730        /* GET STATUS for Interface*/
;;;731        else if (Type_Recipient == (STANDARD_REQUEST | INTERFACE_RECIPIENT))
000082  4879              LDR      r0,|L3.616|
000084  6800              LDR      r0,[r0,#0]  ; pInformation
000086  7800              LDRB     r0,[r0,#0]
000088  f000007f          AND      r0,r0,#0x7f
00008c  2801              CMP      r0,#1
00008e  d110              BNE      |L3.178|
;;;732        {
;;;733          if (((*pProperty->Class_Get_Interface_Setting)(pInformation->USBwIndex0, 0) == USB_SUCCESS)
000090  4975              LDR      r1,|L3.616|
000092  6809              LDR      r1,[r1,#0]  ; pInformation
000094  7948              LDRB     r0,[r1,#5]
000096  4975              LDR      r1,|L3.620|
000098  6809              LDR      r1,[r1,#0]  ; pProperty
00009a  698a              LDR      r2,[r1,#0x18]
00009c  2100              MOVS     r1,#0
00009e  4790              BLX      r2
0000a0  2800              CMP      r0,#0
0000a2  d162              BNE      |L3.362|
;;;734              && (pInformation->Current_Configuration != 0))
0000a4  4870              LDR      r0,|L3.616|
0000a6  6800              LDR      r0,[r0,#0]  ; pInformation
0000a8  7a80              LDRB     r0,[r0,#0xa]
0000aa  2800              CMP      r0,#0
0000ac  d05d              BEQ      |L3.362|
;;;735          {
;;;736            CopyRoutine = Standard_GetStatus;
0000ae  4f70              LDR      r7,|L3.624|
0000b0  e05b              B        |L3.362|
                  |L3.178|
;;;737          }
;;;738        }
;;;739    
;;;740        /* GET STATUS for EndPoint*/
;;;741        else if (Type_Recipient == (STANDARD_REQUEST | ENDPOINT_RECIPIENT))
0000b2  486d              LDR      r0,|L3.616|
0000b4  6800              LDR      r0,[r0,#0]  ; pInformation
0000b6  7800              LDRB     r0,[r0,#0]
0000b8  f000007f          AND      r0,r0,#0x7f
0000bc  2802              CMP      r0,#2
0000be  d154              BNE      |L3.362|
;;;742        {
;;;743          Related_Endpoint = (pInformation->USBwIndex0 & 0x0f);
0000c0  4869              LDR      r0,|L3.616|
0000c2  6800              LDR      r0,[r0,#0]  ; pInformation
0000c4  7940              LDRB     r0,[r0,#5]
0000c6  f000060f          AND      r6,r0,#0xf
;;;744          Reserved = pInformation->USBwIndex0 & 0x70;
0000ca  4867              LDR      r0,|L3.616|
0000cc  6800              LDR      r0,[r0,#0]  ; pInformation
0000ce  7940              LDRB     r0,[r0,#5]
0000d0  f0000970          AND      r9,r0,#0x70
;;;745    
;;;746          if (ValBit(pInformation->USBwIndex0, 7))
0000d4  4864              LDR      r0,|L3.616|
0000d6  6800              LDR      r0,[r0,#0]  ; pInformation
0000d8  7940              LDRB     r0,[r0,#5]
0000da  f0100f80          TST      r0,#0x80
0000de  d005              BEQ      |L3.236|
;;;747          {
;;;748            /*Get Status of endpoint & stall the request if the related_ENdpoint
;;;749            is Disabled*/
;;;750            Status = _GetEPTxStatus(Related_Endpoint);
0000e0  4864              LDR      r0,|L3.628|
0000e2  f8500026          LDR      r0,[r0,r6,LSL #2]
0000e6  f0000830          AND      r8,r0,#0x30
0000ea  e004              B        |L3.246|
                  |L3.236|
;;;751          }
;;;752          else
;;;753          {
;;;754            Status = _GetEPRxStatus(Related_Endpoint);
0000ec  4861              LDR      r0,|L3.628|
0000ee  f8500026          LDR      r0,[r0,r6,LSL #2]
0000f2  f4005840          AND      r8,r0,#0x3000
                  |L3.246|
;;;755          }
;;;756    
;;;757          if ((Related_Endpoint < Device_Table.Total_Endpoint) && (Reserved == 0)
0000f6  4860              LDR      r0,|L3.632|
0000f8  7800              LDRB     r0,[r0,#0]  ; Device_Table
0000fa  42b0              CMP      r0,r6
0000fc  d935              BLS      |L3.362|
0000fe  f1b90f00          CMP      r9,#0
000102  d132              BNE      |L3.362|
;;;758              && (Status != 0))
000104  f1b80f00          CMP      r8,#0
000108  d02f              BEQ      |L3.362|
;;;759          {
;;;760            CopyRoutine = Standard_GetStatus;
00010a  4f59              LDR      r7,|L3.624|
00010c  e02d              B        |L3.362|
                  |L3.270|
;;;761          }
;;;762        }
;;;763    
;;;764      }
;;;765    
;;;766      /*GET CONFIGURATION*/
;;;767      else if (Request_No == GET_CONFIGURATION)
00010e  2d08              CMP      r5,#8
000110  d107              BNE      |L3.290|
;;;768      {
;;;769        if (Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT))
000112  4855              LDR      r0,|L3.616|
000114  6800              LDR      r0,[r0,#0]  ; pInformation
000116  7800              LDRB     r0,[r0,#0]
000118  f0100f7f          TST      r0,#0x7f
00011c  d125              BNE      |L3.362|
;;;770        {
;;;771          CopyRoutine = Standard_GetConfiguration;
00011e  4f57              LDR      r7,|L3.636|
000120  e023              B        |L3.362|
                  |L3.290|
;;;772        }
;;;773      }
;;;774      /*GET INTERFACE*/
;;;775      else if (Request_No == GET_INTERFACE)
000122  2d0a              CMP      r5,#0xa
000124  d121              BNE      |L3.362|
;;;776      {
;;;777        if ((Type_Recipient == (STANDARD_REQUEST | INTERFACE_RECIPIENT))
000126  4850              LDR      r0,|L3.616|
000128  6800              LDR      r0,[r0,#0]  ; pInformation
00012a  7800              LDRB     r0,[r0,#0]
00012c  f000007f          AND      r0,r0,#0x7f
000130  2801              CMP      r0,#1
000132  d11a              BNE      |L3.362|
;;;778            && (pInformation->Current_Configuration != 0) && (pInformation->USBwValue == 0)
000134  484c              LDR      r0,|L3.616|
000136  6800              LDR      r0,[r0,#0]  ; pInformation
000138  7a80              LDRB     r0,[r0,#0xa]
00013a  b1b0              CBZ      r0,|L3.362|
00013c  484a              LDR      r0,|L3.616|
00013e  6800              LDR      r0,[r0,#0]  ; pInformation
000140  8840              LDRH     r0,[r0,#2]
000142  b990              CBNZ     r0,|L3.362|
;;;779            && (pInformation->USBwIndex1 == 0) && (pInformation->USBwLength == 0x0001)
000144  4848              LDR      r0,|L3.616|
000146  6800              LDR      r0,[r0,#0]  ; pInformation
000148  7900              LDRB     r0,[r0,#4]
00014a  b970              CBNZ     r0,|L3.362|
00014c  4846              LDR      r0,|L3.616|
00014e  6800              LDR      r0,[r0,#0]  ; pInformation
000150  88c0              LDRH     r0,[r0,#6]
000152  2801              CMP      r0,#1
000154  d109              BNE      |L3.362|
;;;780            && ((*pProperty->Class_Get_Interface_Setting)(pInformation->USBwIndex0, 0) == USB_SUCCESS))
000156  4944              LDR      r1,|L3.616|
000158  6809              LDR      r1,[r1,#0]  ; pInformation
00015a  7948              LDRB     r0,[r1,#5]
00015c  4943              LDR      r1,|L3.620|
00015e  6809              LDR      r1,[r1,#0]  ; pProperty
000160  698a              LDR      r2,[r1,#0x18]
000162  2100              MOVS     r1,#0
000164  4790              BLX      r2
000166  b900              CBNZ     r0,|L3.362|
;;;781        {
;;;782          CopyRoutine = Standard_GetInterface;
000168  4f45              LDR      r7,|L3.640|
                  |L3.362|
;;;783        }
;;;784    
;;;785      }
;;;786      
;;;787      if (CopyRoutine)
00016a  b157              CBZ      r7,|L3.386|
;;;788      {
;;;789        pInformation->Ctrl_Info.Usb_wOffset = wOffset;
00016c  483e              LDR      r0,|L3.616|
00016e  6800              LDR      r0,[r0,#0]  ; pInformation
000170  f8a0a012          STRH     r10,[r0,#0x12]
;;;790        pInformation->Ctrl_Info.CopyData = CopyRoutine;
000174  483c              LDR      r0,|L3.616|
000176  6800              LDR      r0,[r0,#0]  ; pInformation
000178  6187              STR      r7,[r0,#0x18]
;;;791        /* sb in the original the cast to word was directly */
;;;792        /* now the cast is made step by step */
;;;793        (*CopyRoutine)(0);
00017a  2000              MOVS     r0,#0
00017c  47b8              BLX      r7
;;;794        Result = USB_SUCCESS;
00017e  2400              MOVS     r4,#0
000180  e00f              B        |L3.418|
                  |L3.386|
;;;795      }
;;;796      else
;;;797      {
;;;798        Result = (*pProperty->Class_Data_Setup)(pInformation->USBbRequest);
000182  4a39              LDR      r2,|L3.616|
000184  6812              LDR      r2,[r2,#0]  ; pInformation
000186  7850              LDRB     r0,[r2,#1]
000188  4a38              LDR      r2,|L3.620|
00018a  6812              LDR      r2,[r2,#0]  ; pProperty
00018c  6911              LDR      r1,[r2,#0x10]
00018e  4788              BLX      r1
000190  4604              MOV      r4,r0
;;;799        if (Result == USB_NOT_READY)
000192  2c03              CMP      r4,#3
000194  d105              BNE      |L3.418|
;;;800        {
;;;801          pInformation->ControlState = PAUSE;
000196  2009              MOVS     r0,#9
000198  4933              LDR      r1,|L3.616|
00019a  6809              LDR      r1,[r1,#0]  ; pInformation
00019c  7208              STRB     r0,[r1,#8]
                  |L3.414|
;;;802          return;
;;;803        }
;;;804      }
;;;805    
;;;806      if (pInformation->Ctrl_Info.Usb_wLength == 0xFFFF)
;;;807      {
;;;808        /* Data is not ready, wait it */
;;;809        pInformation->ControlState = PAUSE;
;;;810        return;
;;;811      }
;;;812      if ((Result == USB_UNSUPPORT) || (pInformation->Ctrl_Info.Usb_wLength == 0))
;;;813      {
;;;814        /* Unsupported request */
;;;815        pInformation->ControlState = STALLED;
;;;816        return;
;;;817      }
;;;818    
;;;819    
;;;820      if (ValBit(pInformation->USBbmRequestType, 7))
;;;821      {
;;;822        /* Device ==> Host */
;;;823        __IO uint32_t wLength = pInformation->USBwLength;
;;;824         
;;;825        /* Restrict the data length to be the one host asks for */
;;;826        if (pInformation->Ctrl_Info.Usb_wLength > wLength)
;;;827        {
;;;828          pInformation->Ctrl_Info.Usb_wLength = wLength;
;;;829        }
;;;830        
;;;831        else if (pInformation->Ctrl_Info.Usb_wLength < pInformation->USBwLength)
;;;832        {
;;;833          if (pInformation->Ctrl_Info.Usb_wLength < pProperty->MaxPacketSize)
;;;834          {
;;;835            Data_Mul_MaxPacketSize = FALSE;
;;;836          }
;;;837          else if ((pInformation->Ctrl_Info.Usb_wLength % pProperty->MaxPacketSize) == 0)
;;;838          {
;;;839            Data_Mul_MaxPacketSize = TRUE;
;;;840          }
;;;841        }   
;;;842    
;;;843        pInformation->Ctrl_Info.PacketSize = pProperty->MaxPacketSize;
;;;844        DataStageIn();
;;;845      }
;;;846      else
;;;847      {
;;;848        pInformation->ControlState = OUT_DATA;
;;;849        vSetEPRxStatus(EP_RX_VALID); /* enable for next data reception */
;;;850      }
;;;851    
;;;852      return;
;;;853    }
00019e  e8bd9ff0          POP      {r4-r12,pc}
                  |L3.418|
0001a2  4831              LDR      r0,|L3.616|
0001a4  6800              LDR      r0,[r0,#0]            ;806  ; pInformation
0001a6  8a00              LDRH     r0,[r0,#0x10]         ;806
0001a8  f5a0417f          SUB      r1,r0,#0xff00         ;806
0001ac  39ff              SUBS     r1,r1,#0xff           ;806
0001ae  d104              BNE      |L3.442|
0001b0  2009              MOVS     r0,#9                 ;809
0001b2  492d              LDR      r1,|L3.616|
0001b4  6809              LDR      r1,[r1,#0]            ;809  ; pInformation
0001b6  7208              STRB     r0,[r1,#8]            ;809
0001b8  e7f1              B        |L3.414|
                  |L3.442|
0001ba  2c02              CMP      r4,#2                 ;812
0001bc  d003              BEQ      |L3.454|
0001be  482a              LDR      r0,|L3.616|
0001c0  6800              LDR      r0,[r0,#0]            ;812  ; pInformation
0001c2  8a00              LDRH     r0,[r0,#0x10]         ;812
0001c4  b920              CBNZ     r0,|L3.464|
                  |L3.454|
0001c6  2008              MOVS     r0,#8                 ;815
0001c8  4927              LDR      r1,|L3.616|
0001ca  6809              LDR      r1,[r1,#0]            ;815  ; pInformation
0001cc  7208              STRB     r0,[r1,#8]            ;815
0001ce  e7e6              B        |L3.414|
                  |L3.464|
0001d0  4825              LDR      r0,|L3.616|
0001d2  6800              LDR      r0,[r0,#0]            ;820  ; pInformation
0001d4  7800              LDRB     r0,[r0,#0]            ;820
0001d6  f0100f80          TST      r0,#0x80              ;820
0001da  d03b              BEQ      |L3.596|
0001dc  4822              LDR      r0,|L3.616|
0001de  6800              LDR      r0,[r0,#0]            ;823  ; pInformation
0001e0  f8b0b006          LDRH     r11,[r0,#6]           ;823
0001e4  4820              LDR      r0,|L3.616|
0001e6  6800              LDR      r0,[r0,#0]            ;826  ; pInformation
0001e8  8a00              LDRH     r0,[r0,#0x10]         ;826
0001ea  4558              CMP      r0,r11                ;826
0001ec  d904              BLS      |L3.504|
0001ee  491e              LDR      r1,|L3.616|
0001f0  6809              LDR      r1,[r1,#0]            ;828  ; pInformation
0001f2  f8a1b010          STRH     r11,[r1,#0x10]        ;828
0001f6  e023              B        |L3.576|
                  |L3.504|
0001f8  481b              LDR      r0,|L3.616|
0001fa  6800              LDR      r0,[r0,#0]            ;831  ; pInformation
0001fc  8a00              LDRH     r0,[r0,#0x10]         ;831
0001fe  491a              LDR      r1,|L3.616|
000200  6809              LDR      r1,[r1,#0]            ;831  ; pInformation
000202  88c9              LDRH     r1,[r1,#6]            ;831
000204  4288              CMP      r0,r1                 ;831
000206  da1b              BGE      |L3.576|
000208  4817              LDR      r0,|L3.616|
00020a  6800              LDR      r0,[r0,#0]            ;833  ; pInformation
00020c  8a00              LDRH     r0,[r0,#0x10]         ;833
00020e  4917              LDR      r1,|L3.620|
000210  6809              LDR      r1,[r1,#0]            ;833  ; pProperty
000212  f891102c          LDRB     r1,[r1,#0x2c]         ;833
000216  4288              CMP      r0,r1                 ;833
000218  da03              BGE      |L3.546|
00021a  2000              MOVS     r0,#0                 ;835
00021c  4919              LDR      r1,|L3.644|
00021e  7008              STRB     r0,[r1,#0]            ;835
000220  e00e              B        |L3.576|
                  |L3.546|
000222  4811              LDR      r0,|L3.616|
000224  6800              LDR      r0,[r0,#0]            ;837  ; pInformation
000226  8a00              LDRH     r0,[r0,#0x10]         ;837
000228  4910              LDR      r1,|L3.620|
00022a  6809              LDR      r1,[r1,#0]            ;837  ; pProperty
00022c  f891102c          LDRB     r1,[r1,#0x2c]         ;837
000230  fb90f2f1          SDIV     r2,r0,r1              ;837
000234  fb010012          MLS      r0,r1,r2,r0           ;837
000238  b910              CBNZ     r0,|L3.576|
00023a  2001              MOVS     r0,#1                 ;839
00023c  4911              LDR      r1,|L3.644|
00023e  7008              STRB     r0,[r1,#0]            ;839
                  |L3.576|
000240  480a              LDR      r0,|L3.620|
000242  6800              LDR      r0,[r0,#0]            ;843  ; pProperty
000244  f890102c          LDRB     r1,[r0,#0x2c]         ;843
000248  4807              LDR      r0,|L3.616|
00024a  6800              LDR      r0,[r0,#0]            ;843  ; pInformation
00024c  8281              STRH     r1,[r0,#0x14]         ;843
00024e  f7fffffe          BL       DataStageIn
000252  e006              B        |L3.610|
                  |L3.596|
000254  2003              MOVS     r0,#3                 ;848
000256  4904              LDR      r1,|L3.616|
000258  6809              LDR      r1,[r1,#0]            ;848  ; pInformation
00025a  7208              STRB     r0,[r1,#8]            ;848
00025c  0300              LSLS     r0,r0,#12             ;849
00025e  490a              LDR      r1,|L3.648|
000260  8008              STRH     r0,[r1,#0]            ;849
                  |L3.610|
000262  bf00              NOP                            ;852
000264  e79b              B        |L3.414|
;;;854    
                          ENDP

000266  0000              DCW      0x0000
                  |L3.616|
                          DCD      pInformation
                  |L3.620|
                          DCD      pProperty
                  |L3.624|
                          DCD      Standard_GetStatus
                  |L3.628|
                          DCD      0x40005c00
                  |L3.632|
                          DCD      Device_Table
                  |L3.636|
                          DCD      Standard_GetConfiguration
                  |L3.640|
                          DCD      Standard_GetInterface
                  |L3.644|
                          DCD      Data_Mul_MaxPacketSize
                  |L3.648|
                          DCD      SaveRState

                          AREA ||i.In0_Process||, CODE, READONLY, ALIGN=2

                  In0_Process PROC
;;;906    *******************************************************************************/
;;;907    uint8_t In0_Process(void)
000000  b510              PUSH     {r4,lr}
;;;908    {
;;;909      uint32_t ControlState = pInformation->ControlState;
000002  4818              LDR      r0,|L4.100|
000004  6800              LDR      r0,[r0,#0]  ; pInformation
000006  7a04              LDRB     r4,[r0,#8]
;;;910    
;;;911      if ((ControlState == IN_DATA) || (ControlState == LAST_IN_DATA))
000008  2c02              CMP      r4,#2
00000a  d001              BEQ      |L4.16|
00000c  2c04              CMP      r4,#4
00000e  d105              BNE      |L4.28|
                  |L4.16|
;;;912      {
;;;913        DataStageIn();
000010  f7fffffe          BL       DataStageIn
;;;914        /* ControlState may be changed outside the function */
;;;915        ControlState = pInformation->ControlState;
000014  4813              LDR      r0,|L4.100|
000016  6800              LDR      r0,[r0,#0]  ; pInformation
000018  7a04              LDRB     r4,[r0,#8]
00001a  e01c              B        |L4.86|
                  |L4.28|
;;;916      }
;;;917    
;;;918      else if (ControlState == WAIT_STATUS_IN)
00001c  2c06              CMP      r4,#6
00001e  d119              BNE      |L4.84|
;;;919      {
;;;920        if ((pInformation->USBbRequest == SET_ADDRESS) &&
000020  4810              LDR      r0,|L4.100|
000022  6800              LDR      r0,[r0,#0]  ; pInformation
000024  7840              LDRB     r0,[r0,#1]
000026  2805              CMP      r0,#5
000028  d10e              BNE      |L4.72|
;;;921            (Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT)))
00002a  480e              LDR      r0,|L4.100|
00002c  6800              LDR      r0,[r0,#0]  ; pInformation
00002e  7800              LDRB     r0,[r0,#0]
000030  f0100f7f          TST      r0,#0x7f
000034  d108              BNE      |L4.72|
;;;922        {
;;;923          SetDeviceAddress(pInformation->USBwValue0);
000036  490b              LDR      r1,|L4.100|
000038  6809              LDR      r1,[r1,#0]  ; pInformation
00003a  78c8              LDRB     r0,[r1,#3]
00003c  f7fffffe          BL       SetDeviceAddress
;;;924          pUser_Standard_Requests->User_SetDeviceAddress();
000040  4909              LDR      r1,|L4.104|
000042  6809              LDR      r1,[r1,#0]  ; pUser_Standard_Requests
000044  6a08              LDR      r0,[r1,#0x20]
000046  4780              BLX      r0
                  |L4.72|
;;;925        }
;;;926        (*pProperty->Process_Status_IN)();
000048  4908              LDR      r1,|L4.108|
00004a  6809              LDR      r1,[r1,#0]  ; pProperty
00004c  6888              LDR      r0,[r1,#8]
00004e  4780              BLX      r0
;;;927        ControlState = STALLED;
000050  2408              MOVS     r4,#8
000052  e000              B        |L4.86|
                  |L4.84|
;;;928      }
;;;929    
;;;930      else
;;;931      {
;;;932        ControlState = STALLED;
000054  2408              MOVS     r4,#8
                  |L4.86|
;;;933      }
;;;934    
;;;935      pInformation->ControlState = ControlState;
000056  4903              LDR      r1,|L4.100|
000058  6809              LDR      r1,[r1,#0]  ; pInformation
00005a  720c              STRB     r4,[r1,#8]
;;;936    
;;;937      return Post0_Process();
00005c  f7fffffe          BL       Post0_Process
;;;938    }
000060  bd10              POP      {r4,pc}
;;;939    
                          ENDP

000062  0000              DCW      0x0000
                  |L4.100|
                          DCD      pInformation
                  |L4.104|
                          DCD      pUser_Standard_Requests
                  |L4.108|
                          DCD      pProperty

                          AREA ||i.NOP_Process||, CODE, READONLY, ALIGN=1

                  NOP_Process PROC
;;;1028   *******************************************************************************/
;;;1029   void NOP_Process(void)
000000  4770              BX       lr
;;;1030   {
;;;1031   }
;;;1032   
                          ENDP


                          AREA ||i.NoData_Setup0||, CODE, READONLY, ALIGN=2

                  NoData_Setup0 PROC
;;;559    *******************************************************************************/
;;;560    void NoData_Setup0(void)
000000  b570              PUSH     {r4-r6,lr}
;;;561    {
;;;562      RESULT Result = USB_UNSUPPORT;
000002  2602              MOVS     r6,#2
;;;563      uint32_t RequestNo = pInformation->USBbRequest;
000004  4846              LDR      r0,|L6.288|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  7844              LDRB     r4,[r0,#1]
;;;564      uint32_t ControlState;
;;;565    
;;;566      if (Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT))
00000a  4845              LDR      r0,|L6.288|
00000c  6800              LDR      r0,[r0,#0]  ; pInformation
00000e  7800              LDRB     r0,[r0,#0]
000010  f0100f7f          TST      r0,#0x7f
000014  d144              BNE      |L6.160|
;;;567      {
;;;568        /* Device Request*/
;;;569        /* SET_CONFIGURATION*/
;;;570        if (RequestNo == SET_CONFIGURATION)
000016  2c09              CMP      r4,#9
000018  d103              BNE      |L6.34|
;;;571        {
;;;572          Result = Standard_SetConfiguration();
00001a  f7fffffe          BL       Standard_SetConfiguration
00001e  4606              MOV      r6,r0
000020  e05f              B        |L6.226|
                  |L6.34|
;;;573        }
;;;574    
;;;575        /*SET ADDRESS*/
;;;576        else if (RequestNo == SET_ADDRESS)
000022  2c05              CMP      r4,#5
000024  d114              BNE      |L6.80|
;;;577        {
;;;578          if ((pInformation->USBwValue0 > 127) || (pInformation->USBwValue1 != 0)
000026  483e              LDR      r0,|L6.288|
000028  6800              LDR      r0,[r0,#0]  ; pInformation
00002a  78c0              LDRB     r0,[r0,#3]
00002c  287f              CMP      r0,#0x7f
00002e  dc0b              BGT      |L6.72|
000030  483b              LDR      r0,|L6.288|
000032  6800              LDR      r0,[r0,#0]  ; pInformation
000034  7880              LDRB     r0,[r0,#2]
000036  b938              CBNZ     r0,|L6.72|
;;;579              || (pInformation->USBwIndex != 0)
000038  4839              LDR      r0,|L6.288|
00003a  6800              LDR      r0,[r0,#0]  ; pInformation
00003c  8880              LDRH     r0,[r0,#4]
00003e  b918              CBNZ     r0,|L6.72|
;;;580              || (pInformation->Current_Configuration != 0))
000040  4837              LDR      r0,|L6.288|
000042  6800              LDR      r0,[r0,#0]  ; pInformation
000044  7a80              LDRB     r0,[r0,#0xa]
000046  b108              CBZ      r0,|L6.76|
                  |L6.72|
;;;581            /* Device Address should be 127 or less*/
;;;582          {
;;;583            ControlState = STALLED;
000048  2508              MOVS     r5,#8
;;;584            goto exit_NoData_Setup0;
00004a  e065              B        |L6.280|
                  |L6.76|
;;;585          }
;;;586          else
;;;587          {
;;;588            Result = USB_SUCCESS;
00004c  2600              MOVS     r6,#0
00004e  e048              B        |L6.226|
                  |L6.80|
;;;589          }
;;;590        }
;;;591        /*SET FEATURE for Device*/
;;;592        else if (RequestNo == SET_FEATURE)
000050  2c03              CMP      r4,#3
000052  d10e              BNE      |L6.114|
;;;593        {
;;;594          if ((pInformation->USBwValue0 == DEVICE_REMOTE_WAKEUP) \
000054  4832              LDR      r0,|L6.288|
000056  6800              LDR      r0,[r0,#0]  ; pInformation
000058  78c0              LDRB     r0,[r0,#3]
00005a  2801              CMP      r0,#1
00005c  d107              BNE      |L6.110|
;;;595              && (pInformation->USBwIndex == 0))
00005e  4830              LDR      r0,|L6.288|
000060  6800              LDR      r0,[r0,#0]  ; pInformation
000062  8880              LDRH     r0,[r0,#4]
000064  b918              CBNZ     r0,|L6.110|
;;;596          {
;;;597            Result = Standard_SetDeviceFeature();
000066  f7fffffe          BL       Standard_SetDeviceFeature
00006a  4606              MOV      r6,r0
00006c  e039              B        |L6.226|
                  |L6.110|
;;;598          }
;;;599          else
;;;600          {
;;;601            Result = USB_UNSUPPORT;
00006e  2602              MOVS     r6,#2
000070  e037              B        |L6.226|
                  |L6.114|
;;;602          }
;;;603        }
;;;604        /*Clear FEATURE for Device */
;;;605        else if (RequestNo == CLEAR_FEATURE)
000072  2c01              CMP      r4,#1
000074  d135              BNE      |L6.226|
;;;606        {
;;;607          if (pInformation->USBwValue0 == DEVICE_REMOTE_WAKEUP
000076  482a              LDR      r0,|L6.288|
000078  6800              LDR      r0,[r0,#0]  ; pInformation
00007a  78c0              LDRB     r0,[r0,#3]
00007c  2801              CMP      r0,#1
00007e  d10d              BNE      |L6.156|
;;;608              && pInformation->USBwIndex == 0
000080  4827              LDR      r0,|L6.288|
000082  6800              LDR      r0,[r0,#0]  ; pInformation
000084  8880              LDRH     r0,[r0,#4]
000086  b948              CBNZ     r0,|L6.156|
;;;609              && ValBit(pInformation->Current_Feature, 5))
000088  4825              LDR      r0,|L6.288|
00008a  6800              LDR      r0,[r0,#0]  ; pInformation
00008c  7a40              LDRB     r0,[r0,#9]
00008e  f0100f20          TST      r0,#0x20
000092  d003              BEQ      |L6.156|
;;;610          {
;;;611            Result = Standard_ClearFeature();
000094  f7fffffe          BL       Standard_ClearFeature
000098  4606              MOV      r6,r0
00009a  e022              B        |L6.226|
                  |L6.156|
;;;612          }
;;;613          else
;;;614          {
;;;615            Result = USB_UNSUPPORT;
00009c  2602              MOVS     r6,#2
00009e  e020              B        |L6.226|
                  |L6.160|
;;;616          }
;;;617        }
;;;618    
;;;619      }
;;;620    
;;;621      /* Interface Request*/
;;;622      else if (Type_Recipient == (STANDARD_REQUEST | INTERFACE_RECIPIENT))
0000a0  481f              LDR      r0,|L6.288|
0000a2  6800              LDR      r0,[r0,#0]  ; pInformation
0000a4  7800              LDRB     r0,[r0,#0]
0000a6  f000007f          AND      r0,r0,#0x7f
0000aa  2801              CMP      r0,#1
0000ac  d105              BNE      |L6.186|
;;;623      {
;;;624        /*SET INTERFACE*/
;;;625        if (RequestNo == SET_INTERFACE)
0000ae  2c0b              CMP      r4,#0xb
0000b0  d117              BNE      |L6.226|
;;;626        {
;;;627          Result = Standard_SetInterface();
0000b2  f7fffffe          BL       Standard_SetInterface
0000b6  4606              MOV      r6,r0
0000b8  e013              B        |L6.226|
                  |L6.186|
;;;628        }
;;;629      }
;;;630    
;;;631      /* EndPoint Request*/
;;;632      else if (Type_Recipient == (STANDARD_REQUEST | ENDPOINT_RECIPIENT))
0000ba  4819              LDR      r0,|L6.288|
0000bc  6800              LDR      r0,[r0,#0]  ; pInformation
0000be  7800              LDRB     r0,[r0,#0]
0000c0  f000007f          AND      r0,r0,#0x7f
0000c4  2802              CMP      r0,#2
0000c6  d10b              BNE      |L6.224|
;;;633      {
;;;634        /*CLEAR FEATURE for EndPoint*/
;;;635        if (RequestNo == CLEAR_FEATURE)
0000c8  2c01              CMP      r4,#1
0000ca  d103              BNE      |L6.212|
;;;636        {
;;;637          Result = Standard_ClearFeature();
0000cc  f7fffffe          BL       Standard_ClearFeature
0000d0  4606              MOV      r6,r0
0000d2  e006              B        |L6.226|
                  |L6.212|
;;;638        }
;;;639        /* SET FEATURE for EndPoint*/
;;;640        else if (RequestNo == SET_FEATURE)
0000d4  2c03              CMP      r4,#3
0000d6  d104              BNE      |L6.226|
;;;641        {
;;;642          Result = Standard_SetEndPointFeature();
0000d8  f7fffffe          BL       Standard_SetEndPointFeature
0000dc  4606              MOV      r6,r0
0000de  e000              B        |L6.226|
                  |L6.224|
;;;643        }
;;;644      }
;;;645      else
;;;646      {
;;;647        Result = USB_UNSUPPORT;
0000e0  2602              MOVS     r6,#2
                  |L6.226|
;;;648      }
;;;649    
;;;650    
;;;651      if (Result != USB_SUCCESS)
0000e2  b14e              CBZ      r6,|L6.248|
;;;652      {
;;;653        Result = (*pProperty->Class_NoData_Setup)(RequestNo);
0000e4  480f              LDR      r0,|L6.292|
0000e6  6800              LDR      r0,[r0,#0]  ; pProperty
0000e8  6941              LDR      r1,[r0,#0x14]
0000ea  b2e0              UXTB     r0,r4
0000ec  4788              BLX      r1
0000ee  4606              MOV      r6,r0
;;;654        if (Result == USB_NOT_READY)
0000f0  2e03              CMP      r6,#3
0000f2  d101              BNE      |L6.248|
;;;655        {
;;;656          ControlState = PAUSE;
0000f4  2509              MOVS     r5,#9
;;;657          goto exit_NoData_Setup0;
0000f6  e00f              B        |L6.280|
                  |L6.248|
;;;658        }
;;;659      }
;;;660    
;;;661      if (Result != USB_SUCCESS)
0000f8  b10e              CBZ      r6,|L6.254|
;;;662      {
;;;663        ControlState = STALLED;
0000fa  2508              MOVS     r5,#8
;;;664        goto exit_NoData_Setup0;
0000fc  e00c              B        |L6.280|
                  |L6.254|
;;;665      }
;;;666    
;;;667      ControlState = WAIT_STATUS_IN;/* After no data stage SETUP */
0000fe  2506              MOVS     r5,#6
;;;668    
;;;669      USB_StatusIn();
000100  2100              MOVS     r1,#0
000102  4809              LDR      r0,|L6.296|
000104  6800              LDR      r0,[r0,#0]
000106  b280              UXTH     r0,r0
000108  1c80              ADDS     r0,r0,#2
00010a  4a08              LDR      r2,|L6.300|
00010c  f8421010          STR      r1,[r2,r0,LSL #1]
000110  2030              MOVS     r0,#0x30
000112  4907              LDR      r1,|L6.304|
000114  8008              STRH     r0,[r1,#0]
;;;670    
;;;671    exit_NoData_Setup0:
000116  bf00              NOP      
                  |L6.280|
;;;672      pInformation->ControlState = ControlState;
000118  4901              LDR      r1,|L6.288|
00011a  6809              LDR      r1,[r1,#0]  ; pInformation
00011c  720d              STRB     r5,[r1,#8]
;;;673      return;
;;;674    }
00011e  bd70              POP      {r4-r6,pc}
;;;675    
                          ENDP

                  |L6.288|
                          DCD      pInformation
                  |L6.292|
                          DCD      pProperty
                  |L6.296|
                          DCD      0x40005c50
                  |L6.300|
                          DCD      0x40006000
                  |L6.304|
                          DCD      SaveTState

                          AREA ||i.Out0_Process||, CODE, READONLY, ALIGN=2

                  Out0_Process PROC
;;;946    *******************************************************************************/
;;;947    uint8_t Out0_Process(void)
000000  b510              PUSH     {r4,lr}
;;;948    {
;;;949      uint32_t ControlState = pInformation->ControlState;
000002  4811              LDR      r0,|L7.72|
000004  6800              LDR      r0,[r0,#0]  ; pInformation
000006  7a04              LDRB     r4,[r0,#8]
;;;950    
;;;951      if ((ControlState == IN_DATA) || (ControlState == LAST_IN_DATA))
000008  2c02              CMP      r4,#2
00000a  d001              BEQ      |L7.16|
00000c  2c04              CMP      r4,#4
00000e  d101              BNE      |L7.20|
                  |L7.16|
;;;952      {
;;;953        /* host aborts the transfer before finish */
;;;954        ControlState = STALLED;
000010  2408              MOVS     r4,#8
000012  e012              B        |L7.58|
                  |L7.20|
;;;955      }
;;;956      else if ((ControlState == OUT_DATA) || (ControlState == LAST_OUT_DATA))
000014  2c03              CMP      r4,#3
000016  d001              BEQ      |L7.28|
000018  2c05              CMP      r4,#5
00001a  d105              BNE      |L7.40|
                  |L7.28|
;;;957      {
;;;958        DataStageOut();
00001c  f7fffffe          BL       DataStageOut
;;;959        ControlState = pInformation->ControlState; /* may be changed outside the function */
000020  4809              LDR      r0,|L7.72|
000022  6800              LDR      r0,[r0,#0]  ; pInformation
000024  7a04              LDRB     r4,[r0,#8]
000026  e008              B        |L7.58|
                  |L7.40|
;;;960      }
;;;961    
;;;962      else if (ControlState == WAIT_STATUS_OUT)
000028  2c07              CMP      r4,#7
00002a  d105              BNE      |L7.56|
;;;963      {
;;;964        (*pProperty->Process_Status_OUT)();
00002c  4907              LDR      r1,|L7.76|
00002e  6809              LDR      r1,[r1,#0]  ; pProperty
000030  68c8              LDR      r0,[r1,#0xc]
000032  4780              BLX      r0
;;;965        ControlState = STALLED;
000034  2408              MOVS     r4,#8
000036  e000              B        |L7.58|
                  |L7.56|
;;;966      }
;;;967    
;;;968    
;;;969      /* Unexpect state, STALL the endpoint */
;;;970      else
;;;971      {
;;;972        ControlState = STALLED;
000038  2408              MOVS     r4,#8
                  |L7.58|
;;;973      }
;;;974    
;;;975      pInformation->ControlState = ControlState;
00003a  4903              LDR      r1,|L7.72|
00003c  6809              LDR      r1,[r1,#0]  ; pInformation
00003e  720c              STRB     r4,[r1,#8]
;;;976    
;;;977      return Post0_Process();
000040  f7fffffe          BL       Post0_Process
;;;978    }
000044  bd10              POP      {r4,pc}
;;;979    
                          ENDP

000046  0000              DCW      0x0000
                  |L7.72|
                          DCD      pInformation
                  |L7.76|
                          DCD      pProperty

                          AREA ||i.Post0_Process||, CODE, READONLY, ALIGN=2

                  Post0_Process PROC
;;;987    *******************************************************************************/
;;;988    uint8_t Post0_Process(void)
000000  b510              PUSH     {r4,lr}
;;;989    {
;;;990       
;;;991      SetEPRxCount(ENDP0, Device_Property.MaxPacketSize);
000002  480d              LDR      r0,|L8.56|
000004  f890102c          LDRB     r1,[r0,#0x2c]  ; Device_Property
000008  2000              MOVS     r0,#0
00000a  f7fffffe          BL       SetEPRxCount
;;;992    
;;;993      if (pInformation->ControlState == STALLED)
00000e  480b              LDR      r0,|L8.60|
000010  6800              LDR      r0,[r0,#0]  ; pInformation
000012  7a00              LDRB     r0,[r0,#8]
000014  2808              CMP      r0,#8
000016  d105              BNE      |L8.36|
;;;994      {
;;;995        vSetEPRxStatus(EP_RX_STALL);
000018  0240              LSLS     r0,r0,#9
00001a  4909              LDR      r1,|L8.64|
00001c  8008              STRH     r0,[r1,#0]
;;;996        vSetEPTxStatus(EP_TX_STALL);
00001e  2010              MOVS     r0,#0x10
000020  4908              LDR      r1,|L8.68|
000022  8008              STRH     r0,[r1,#0]
                  |L8.36|
;;;997      }
;;;998    
;;;999      return (pInformation->ControlState == PAUSE);
000024  4805              LDR      r0,|L8.60|
000026  6800              LDR      r0,[r0,#0]  ; pInformation
000028  7a00              LDRB     r0,[r0,#8]
00002a  2809              CMP      r0,#9
00002c  d101              BNE      |L8.50|
00002e  2001              MOVS     r0,#1
                  |L8.48|
;;;1000   }
000030  bd10              POP      {r4,pc}
                  |L8.50|
000032  2000              MOVS     r0,#0                 ;999
000034  e7fc              B        |L8.48|
;;;1001   
                          ENDP

000036  0000              DCW      0x0000
                  |L8.56|
                          DCD      Device_Property
                  |L8.60|
                          DCD      pInformation
                  |L8.64|
                          DCD      SaveRState
                  |L8.68|
                          DCD      SaveTState

                          AREA ||i.SetDeviceAddress||, CODE, READONLY, ALIGN=2

                  SetDeviceAddress PROC
;;;1008   *******************************************************************************/
;;;1009   void SetDeviceAddress(uint8_t Val)
000000  b530              PUSH     {r4,r5,lr}
;;;1010   {
000002  4601              MOV      r1,r0
;;;1011     uint32_t i;
;;;1012     uint32_t nEP = Device_Table.Total_Endpoint;
000004  4b0e              LDR      r3,|L9.64|
000006  781a              LDRB     r2,[r3,#0]  ; Device_Table
;;;1013   
;;;1014     /* set address in every used endpoint */
;;;1015     for (i = 0; i < nEP; i++)
000008  2000              MOVS     r0,#0
00000a  e011              B        |L9.48|
                  |L9.12|
;;;1016     {
;;;1017       _SetEPAddress((uint8_t)i, (uint8_t)i);
00000c  b2c3              UXTB     r3,r0
00000e  4c0d              LDR      r4,|L9.68|
000010  f8543023          LDR      r3,[r4,r3,LSL #2]
000014  b29b              UXTH     r3,r3
000016  f648748f          MOV      r4,#0x8f8f
00001a  4023              ANDS     r3,r3,r4
00001c  f2480480          MOV      r4,#0x8080
000020  4323              ORRS     r3,r3,r4
000022  b2c4              UXTB     r4,r0
000024  4323              ORRS     r3,r3,r4
000026  b2c4              UXTB     r4,r0
000028  4d06              LDR      r5,|L9.68|
00002a  f8453024          STR      r3,[r5,r4,LSL #2]
00002e  1c40              ADDS     r0,r0,#1              ;1015
                  |L9.48|
000030  4290              CMP      r0,r2                 ;1015
000032  d3eb              BCC      |L9.12|
;;;1018     } /* for */
;;;1019     _SetDADDR(Val | DADDR_EF); /* set device address and enable function */ 
000034  f0410380          ORR      r3,r1,#0x80
000038  4c02              LDR      r4,|L9.68|
00003a  344c              ADDS     r4,r4,#0x4c
00003c  6023              STR      r3,[r4,#0]
;;;1020   }
00003e  bd30              POP      {r4,r5,pc}
;;;1021   
                          ENDP

                  |L9.64|
                          DCD      Device_Table
                  |L9.68|
                          DCD      0x40005c00

                          AREA ||i.Setup0_Process||, CODE, READONLY, ALIGN=2

                  Setup0_Process PROC
;;;861    *******************************************************************************/
;;;862    uint8_t Setup0_Process(void)
000000  b538              PUSH     {r3-r5,lr}
;;;863    {
;;;864    
;;;865      union
;;;866      {
;;;867        uint8_t* b;
;;;868        uint16_t* w;
;;;869      } pBuf;
;;;870      uint16_t offset = 1;
000002  2401              MOVS     r4,#1
;;;871      
;;;872      pBuf.b = PMAAddr + (uint8_t *)(_GetEPRxAddr(ENDP0) * 2); /* *2 for 32 bits addr */
000004  4829              LDR      r0,|L10.172|
000006  6800              LDR      r0,[r0,#0]
000008  b280              UXTH     r0,r0
00000a  1d00              ADDS     r0,r0,#4
00000c  4928              LDR      r1,|L10.176|
00000e  f8510010          LDR      r0,[r1,r0,LSL #1]
000012  b280              UXTH     r0,r0
000014  eb010040          ADD      r0,r1,r0,LSL #1
000018  9000              STR      r0,[sp,#0]
;;;873    
;;;874      if (pInformation->ControlState != PAUSE)
00001a  4826              LDR      r0,|L10.180|
00001c  6800              LDR      r0,[r0,#0]  ; pInformation
00001e  7a00              LDRB     r0,[r0,#8]
000020  2809              CMP      r0,#9
000022  d032              BEQ      |L10.138|
;;;875      {
;;;876        pInformation->USBbmRequestType = *pBuf.b++; /* bmRequestType */
000024  9800              LDR      r0,[sp,#0]
000026  7800              LDRB     r0,[r0,#0]
000028  4922              LDR      r1,|L10.180|
00002a  6809              LDR      r1,[r1,#0]  ; pInformation
00002c  7008              STRB     r0,[r1,#0]
00002e  9800              LDR      r0,[sp,#0]
000030  1c40              ADDS     r0,r0,#1
000032  9000              STR      r0,[sp,#0]
;;;877        pInformation->USBbRequest = *pBuf.b++; /* bRequest */
000034  9800              LDR      r0,[sp,#0]
000036  7800              LDRB     r0,[r0,#0]
000038  491e              LDR      r1,|L10.180|
00003a  6809              LDR      r1,[r1,#0]  ; pInformation
00003c  7048              STRB     r0,[r1,#1]
00003e  9800              LDR      r0,[sp,#0]
000040  1c40              ADDS     r0,r0,#1
000042  9000              STR      r0,[sp,#0]
;;;878        pBuf.w += offset;  /* word not accessed because of 32 bits addressing */
000044  9800              LDR      r0,[sp,#0]
000046  eb000044          ADD      r0,r0,r4,LSL #1
00004a  9000              STR      r0,[sp,#0]
;;;879        pInformation->USBwValue = ByteSwap(*pBuf.w++); /* wValue */
00004c  9900              LDR      r1,[sp,#0]
00004e  f8310b02          LDRH     r0,[r1],#2
000052  9100              STR      r1,[sp,#0]
000054  f7fffffe          BL       ByteSwap
000058  4916              LDR      r1,|L10.180|
00005a  6809              LDR      r1,[r1,#0]  ; pInformation
00005c  8048              STRH     r0,[r1,#2]
;;;880        pBuf.w += offset;  /* word not accessed because of 32 bits addressing */
00005e  9800              LDR      r0,[sp,#0]
000060  eb000044          ADD      r0,r0,r4,LSL #1
000064  9000              STR      r0,[sp,#0]
;;;881        pInformation->USBwIndex  = ByteSwap(*pBuf.w++); /* wIndex */
000066  9900              LDR      r1,[sp,#0]
000068  f8310b02          LDRH     r0,[r1],#2
00006c  9100              STR      r1,[sp,#0]
00006e  f7fffffe          BL       ByteSwap
000072  4910              LDR      r1,|L10.180|
000074  6809              LDR      r1,[r1,#0]  ; pInformation
000076  8088              STRH     r0,[r1,#4]
;;;882        pBuf.w += offset;  /* word not accessed because of 32 bits addressing */
000078  9800              LDR      r0,[sp,#0]
00007a  eb000044          ADD      r0,r0,r4,LSL #1
00007e  9000              STR      r0,[sp,#0]
;;;883        pInformation->USBwLength = *pBuf.w; /* wLength */
000080  9800              LDR      r0,[sp,#0]
000082  8800              LDRH     r0,[r0,#0]
000084  490b              LDR      r1,|L10.180|
000086  6809              LDR      r1,[r1,#0]  ; pInformation
000088  80c8              STRH     r0,[r1,#6]
                  |L10.138|
;;;884      }
;;;885    
;;;886      pInformation->ControlState = SETTING_UP;
00008a  2001              MOVS     r0,#1
00008c  4909              LDR      r1,|L10.180|
00008e  6809              LDR      r1,[r1,#0]  ; pInformation
000090  7208              STRB     r0,[r1,#8]
;;;887      if (pInformation->USBwLength == 0)
000092  4808              LDR      r0,|L10.180|
000094  6800              LDR      r0,[r0,#0]  ; pInformation
000096  88c0              LDRH     r0,[r0,#6]
000098  b910              CBNZ     r0,|L10.160|
;;;888      {
;;;889        /* Setup with no data stage */
;;;890        NoData_Setup0();
00009a  f7fffffe          BL       NoData_Setup0
00009e  e001              B        |L10.164|
                  |L10.160|
;;;891      }
;;;892      else
;;;893      {
;;;894        /* Setup with data stage */
;;;895        Data_Setup0();
0000a0  f7fffffe          BL       Data_Setup0
                  |L10.164|
;;;896      }
;;;897      return Post0_Process();
0000a4  f7fffffe          BL       Post0_Process
;;;898    }
0000a8  bd38              POP      {r3-r5,pc}
;;;899    
                          ENDP

0000aa  0000              DCW      0x0000
                  |L10.172|
                          DCD      0x40005c50
                  |L10.176|
                          DCD      0x40006000
                  |L10.180|
                          DCD      pInformation

                          AREA ||i.Standard_ClearFeature||, CODE, READONLY, ALIGN=2

                  Standard_ClearFeature PROC
;;;252    *******************************************************************************/
;;;253    RESULT Standard_ClearFeature(void)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;254    {
;;;255      uint32_t     Type_Rec = Type_Recipient;
000004  484d              LDR      r0,|L11.316|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  7800              LDRB     r0,[r0,#0]
00000a  f000087f          AND      r8,r0,#0x7f
;;;256      uint32_t     Status;
;;;257    
;;;258    
;;;259      if (Type_Rec == (STANDARD_REQUEST | DEVICE_RECIPIENT))
00000e  f1b80f00          CMP      r8,#0
000012  d10a              BNE      |L11.42|
;;;260      {/*Device Clear Feature*/
;;;261        ClrBit(pInformation->Current_Feature, 5);
000014  4849              LDR      r0,|L11.316|
000016  6800              LDR      r0,[r0,#0]  ; pInformation
000018  7a40              LDRB     r0,[r0,#9]
00001a  f00000df          AND      r0,r0,#0xdf
00001e  4947              LDR      r1,|L11.316|
000020  6809              LDR      r1,[r1,#0]  ; pInformation
000022  7248              STRB     r0,[r1,#9]
;;;262        return USB_SUCCESS;
000024  2000              MOVS     r0,#0
                  |L11.38|
;;;263      }
;;;264      else if (Type_Rec == (STANDARD_REQUEST | ENDPOINT_RECIPIENT))
;;;265      {/*EndPoint Clear Feature*/
;;;266        DEVICE* pDev;
;;;267        uint32_t Related_Endpoint;
;;;268        uint32_t wIndex0;
;;;269        uint32_t rEP;
;;;270    
;;;271        if ((pInformation->USBwValue != ENDPOINT_STALL)
;;;272            || (pInformation->USBwIndex1 != 0))
;;;273        {
;;;274          return USB_UNSUPPORT;
;;;275        }
;;;276    
;;;277        pDev = &Device_Table;
;;;278        wIndex0 = pInformation->USBwIndex0;
;;;279        rEP = wIndex0 & ~0x80;
;;;280        Related_Endpoint = ENDP0 + rEP;
;;;281    
;;;282        if (ValBit(pInformation->USBwIndex0, 7))
;;;283        {
;;;284          /*Get Status of endpoint & stall the request if the related_ENdpoint
;;;285          is Disabled*/
;;;286          Status = _GetEPTxStatus(Related_Endpoint);
;;;287        }
;;;288        else
;;;289        {
;;;290          Status = _GetEPRxStatus(Related_Endpoint);
;;;291        }
;;;292    
;;;293        if ((rEP >= pDev->Total_Endpoint) || (Status == 0)
;;;294            || (pInformation->Current_Configuration == 0))
;;;295        {
;;;296          return USB_UNSUPPORT;
;;;297        }
;;;298    
;;;299    
;;;300        if (wIndex0 & 0x80)
;;;301        {
;;;302          /* IN endpoint */
;;;303          if (_GetTxStallStatus(Related_Endpoint ))
;;;304          {
;;;305            ClearDTOG_TX(Related_Endpoint);
;;;306            SetEPTxStatus(Related_Endpoint, EP_TX_VALID);
;;;307          }
;;;308        }
;;;309        else
;;;310        {
;;;311          /* OUT endpoint */
;;;312          if (_GetRxStallStatus(Related_Endpoint))
;;;313          {
;;;314            if (Related_Endpoint == ENDP0)
;;;315            {
;;;316              /* After clear the STALL, enable the default endpoint receiver */
;;;317              SetEPRxCount(Related_Endpoint, Device_Property.MaxPacketSize);
;;;318              _SetEPRxStatus(Related_Endpoint, EP_RX_VALID);
;;;319            }
;;;320            else
;;;321            {
;;;322              ClearDTOG_RX(Related_Endpoint);
;;;323              _SetEPRxStatus(Related_Endpoint, EP_RX_VALID);
;;;324            }
;;;325          }
;;;326        }
;;;327        pUser_Standard_Requests->User_ClearFeature();
;;;328        return USB_SUCCESS;
;;;329      }
;;;330    
;;;331      return USB_UNSUPPORT;
;;;332    }
000026  e8bd87f0          POP      {r4-r10,pc}
                  |L11.42|
00002a  f1b80f02          CMP      r8,#2                 ;264
00002e  d17d              BNE      |L11.300|
000030  4842              LDR      r0,|L11.316|
000032  6800              LDR      r0,[r0,#0]            ;271  ; pInformation
000034  8840              LDRH     r0,[r0,#2]            ;271
000036  b918              CBNZ     r0,|L11.64|
000038  4840              LDR      r0,|L11.316|
00003a  6800              LDR      r0,[r0,#0]            ;272  ; pInformation
00003c  7900              LDRB     r0,[r0,#4]            ;272
00003e  b108              CBZ      r0,|L11.68|
                  |L11.64|
000040  2002              MOVS     r0,#2                 ;274
000042  e7f0              B        |L11.38|
                  |L11.68|
000044  f8df90f8          LDR      r9,|L11.320|
000048  483c              LDR      r0,|L11.316|
00004a  6800              LDR      r0,[r0,#0]            ;278  ; pInformation
00004c  7947              LDRB     r7,[r0,#5]            ;278
00004e  f0270580          BIC      r5,r7,#0x80           ;279
000052  462c              MOV      r4,r5                 ;280
000054  4839              LDR      r0,|L11.316|
000056  6800              LDR      r0,[r0,#0]            ;282  ; pInformation
000058  7940              LDRB     r0,[r0,#5]            ;282
00005a  f0100f80          TST      r0,#0x80              ;282
00005e  d005              BEQ      |L11.108|
000060  4838              LDR      r0,|L11.324|
000062  f8500024          LDR      r0,[r0,r4,LSL #2]     ;286
000066  f0000630          AND      r6,r0,#0x30           ;286
00006a  e004              B        |L11.118|
                  |L11.108|
00006c  4835              LDR      r0,|L11.324|
00006e  f8500024          LDR      r0,[r0,r4,LSL #2]     ;290
000072  f4005640          AND      r6,r0,#0x3000         ;290
                  |L11.118|
000076  f8990000          LDRB     r0,[r9,#0]            ;293
00007a  42a8              CMP      r0,r5                 ;293
00007c  d904              BLS      |L11.136|
00007e  b11e              CBZ      r6,|L11.136|
000080  482e              LDR      r0,|L11.316|
000082  6800              LDR      r0,[r0,#0]            ;294  ; pInformation
000084  7a80              LDRB     r0,[r0,#0xa]          ;294
000086  b908              CBNZ     r0,|L11.140|
                  |L11.136|
000088  2002              MOVS     r0,#2                 ;296
00008a  e7cc              B        |L11.38|
                  |L11.140|
00008c  f0170f80          TST      r7,#0x80              ;300
000090  d00e              BEQ      |L11.176|
000092  482c              LDR      r0,|L11.324|
000094  f8500024          LDR      r0,[r0,r4,LSL #2]     ;303
000098  f0000030          AND      r0,r0,#0x30           ;303
00009c  2810              CMP      r0,#0x10              ;303
00009e  d141              BNE      |L11.292|
0000a0  b2e0              UXTB     r0,r4                 ;305
0000a2  f7fffffe          BL       ClearDTOG_TX
0000a6  2130              MOVS     r1,#0x30              ;306
0000a8  b2e0              UXTB     r0,r4                 ;306
0000aa  f7fffffe          BL       SetEPTxStatus
0000ae  e039              B        |L11.292|
                  |L11.176|
0000b0  4824              LDR      r0,|L11.324|
0000b2  f8500024          LDR      r0,[r0,r4,LSL #2]     ;312
0000b6  f4005040          AND      r0,r0,#0x3000         ;312
0000ba  f5b05f80          CMP      r0,#0x1000            ;312
0000be  d131              BNE      |L11.292|
0000c0  b9cc              CBNZ     r4,|L11.246|
0000c2  4821              LDR      r0,|L11.328|
0000c4  f890102c          LDRB     r1,[r0,#0x2c]         ;317  ; Device_Property
0000c8  b2e0              UXTB     r0,r4                 ;317
0000ca  f7fffffe          BL       SetEPRxCount
0000ce  491d              LDR      r1,|L11.324|
0000d0  f8511024          LDR      r1,[r1,r4,LSL #2]     ;318
0000d4  b289              UXTH     r1,r1                 ;318
0000d6  f64b728f          MOV      r2,#0xbf8f            ;318
0000da  ea010002          AND      r0,r1,r2              ;318
0000de  f4805080          EOR      r0,r0,#0x1000         ;318
0000e2  f4805000          EOR      r0,r0,#0x2000         ;318
0000e6  f4404100          ORR      r1,r0,#0x8000         ;318
0000ea  f0410180          ORR      r1,r1,#0x80           ;318
0000ee  4a15              LDR      r2,|L11.324|
0000f0  f8421024          STR      r1,[r2,r4,LSL #2]     ;318
0000f4  e016              B        |L11.292|
                  |L11.246|
0000f6  b2e0              UXTB     r0,r4                 ;322
0000f8  f7fffffe          BL       ClearDTOG_RX
0000fc  4911              LDR      r1,|L11.324|
0000fe  f8511024          LDR      r1,[r1,r4,LSL #2]     ;323
000102  b289              UXTH     r1,r1                 ;323
000104  f64b728f          MOV      r2,#0xbf8f            ;323
000108  ea010002          AND      r0,r1,r2              ;323
00010c  f4805080          EOR      r0,r0,#0x1000         ;323
000110  f4805000          EOR      r0,r0,#0x2000         ;323
000114  f4404100          ORR      r1,r0,#0x8000         ;323
000118  f0410180          ORR      r1,r1,#0x80           ;323
00011c  4a09              LDR      r2,|L11.324|
00011e  f8421024          STR      r1,[r2,r4,LSL #2]     ;323
000122  bf00              NOP                            ;323
                  |L11.292|
000124  4909              LDR      r1,|L11.332|
000126  6809              LDR      r1,[r1,#0]            ;327  ; pUser_Standard_Requests
000128  6948              LDR      r0,[r1,#0x14]         ;327
00012a  e000              B        |L11.302|
                  |L11.300|
00012c  e002              B        |L11.308|
                  |L11.302|
00012e  4780              BLX      r0                    ;327
000130  2000              MOVS     r0,#0                 ;328
000132  e778              B        |L11.38|
                  |L11.308|
000134  bf00              NOP                            ;329
000136  2002              MOVS     r0,#2                 ;331
000138  e775              B        |L11.38|
;;;333    
                          ENDP

00013a  0000              DCW      0x0000
                  |L11.316|
                          DCD      pInformation
                  |L11.320|
                          DCD      Device_Table
                  |L11.324|
                          DCD      0x40005c00
                  |L11.328|
                          DCD      Device_Property
                  |L11.332|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_GetConfiguration||, CODE, READONLY, ALIGN=2

                  Standard_GetConfiguration PROC
;;;68     *******************************************************************************/
;;;69     uint8_t *Standard_GetConfiguration(uint16_t Length)
000000  b510              PUSH     {r4,lr}
;;;70     {
000002  4604              MOV      r4,r0
;;;71       if (Length == 0)
000004  b92c              CBNZ     r4,|L12.18|
;;;72       {
;;;73         pInformation->Ctrl_Info.Usb_wLength =
000006  2001              MOVS     r0,#1
000008  4906              LDR      r1,|L12.36|
00000a  6809              LDR      r1,[r1,#0]  ; pInformation
00000c  8208              STRH     r0,[r1,#0x10]
;;;74           sizeof(pInformation->Current_Configuration);
;;;75         return 0;
00000e  2000              MOVS     r0,#0
                  |L12.16|
;;;76       }
;;;77       pUser_Standard_Requests->User_GetConfiguration();
;;;78       return (uint8_t *)&pInformation->Current_Configuration;
;;;79     }
000010  bd10              POP      {r4,pc}
                  |L12.18|
000012  4905              LDR      r1,|L12.40|
000014  6809              LDR      r1,[r1,#0]            ;77  ; pUser_Standard_Requests
000016  6808              LDR      r0,[r1,#0]            ;77
000018  4780              BLX      r0                    ;77
00001a  4802              LDR      r0,|L12.36|
00001c  6800              LDR      r0,[r0,#0]            ;78  ; pInformation
00001e  300a              ADDS     r0,r0,#0xa            ;78
000020  e7f6              B        |L12.16|
;;;80     
                          ENDP

000022  0000              DCW      0x0000
                  |L12.36|
                          DCD      pInformation
                  |L12.40|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_GetDescriptorData||, CODE, READONLY, ALIGN=2

                  Standard_GetDescriptorData PROC
;;;421    *******************************************************************************/
;;;422    uint8_t *Standard_GetDescriptorData(uint16_t Length, ONE_DESCRIPTOR *pDesc)
000000  b510              PUSH     {r4,lr}
;;;423    {
000002  4602              MOV      r2,r0
;;;424      uint32_t  wOffset;
;;;425    
;;;426      wOffset = pInformation->Ctrl_Info.Usb_wOffset;
000004  4806              LDR      r0,|L13.32|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  8a43              LDRH     r3,[r0,#0x12]
;;;427      if (Length == 0)
00000a  b932              CBNZ     r2,|L13.26|
;;;428      {
;;;429        pInformation->Ctrl_Info.Usb_wLength = pDesc->Descriptor_Size - wOffset;
00000c  8888              LDRH     r0,[r1,#4]
00000e  1ac0              SUBS     r0,r0,r3
000010  4c03              LDR      r4,|L13.32|
000012  6824              LDR      r4,[r4,#0]  ; pInformation
000014  8220              STRH     r0,[r4,#0x10]
;;;430        return 0;
000016  2000              MOVS     r0,#0
                  |L13.24|
;;;431      }
;;;432    
;;;433      return pDesc->Descriptor + wOffset;
;;;434    }
000018  bd10              POP      {r4,pc}
                  |L13.26|
00001a  6808              LDR      r0,[r1,#0]            ;433
00001c  4418              ADD      r0,r0,r3              ;433
00001e  e7fb              B        |L13.24|
;;;435    
                          ENDP

                  |L13.32|
                          DCD      pInformation

                          AREA ||i.Standard_GetInterface||, CODE, READONLY, ALIGN=2

                  Standard_GetInterface PROC
;;;114    *******************************************************************************/
;;;115    uint8_t *Standard_GetInterface(uint16_t Length)
000000  b510              PUSH     {r4,lr}
;;;116    {
000002  4604              MOV      r4,r0
;;;117      if (Length == 0)
000004  b92c              CBNZ     r4,|L14.18|
;;;118      {
;;;119        pInformation->Ctrl_Info.Usb_wLength =
000006  2001              MOVS     r0,#1
000008  4906              LDR      r1,|L14.36|
00000a  6809              LDR      r1,[r1,#0]  ; pInformation
00000c  8208              STRH     r0,[r1,#0x10]
;;;120          sizeof(pInformation->Current_AlternateSetting);
;;;121        return 0;
00000e  2000              MOVS     r0,#0
                  |L14.16|
;;;122      }
;;;123      pUser_Standard_Requests->User_GetInterface();
;;;124      return (uint8_t *)&pInformation->Current_AlternateSetting;
;;;125    }
000010  bd10              POP      {r4,pc}
                  |L14.18|
000012  4905              LDR      r1,|L14.40|
000014  6809              LDR      r1,[r1,#0]            ;123  ; pUser_Standard_Requests
000016  6888              LDR      r0,[r1,#8]            ;123
000018  4780              BLX      r0                    ;123
00001a  4802              LDR      r0,|L14.36|
00001c  6800              LDR      r0,[r0,#0]            ;124  ; pInformation
00001e  300c              ADDS     r0,r0,#0xc            ;124
000020  e7f6              B        |L14.16|
;;;126    
                          ENDP

000022  0000              DCW      0x0000
                  |L14.36|
                          DCD      pInformation
                  |L14.40|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_GetStatus||, CODE, READONLY, ALIGN=2

                  Standard_GetStatus PROC
;;;170    *******************************************************************************/
;;;171    uint8_t *Standard_GetStatus(uint16_t Length)
000000  b510              PUSH     {r4,lr}
;;;172    {
000002  4604              MOV      r4,r0
;;;173      if (Length == 0)
000004  b92c              CBNZ     r4,|L15.18|
;;;174      {
;;;175        pInformation->Ctrl_Info.Usb_wLength = 2;
000006  2002              MOVS     r0,#2
000008  4937              LDR      r1,|L15.232|
00000a  6809              LDR      r1,[r1,#0]  ; pInformation
00000c  8208              STRH     r0,[r1,#0x10]
;;;176        return 0;
00000e  2000              MOVS     r0,#0
                  |L15.16|
;;;177      }
;;;178    
;;;179      /* Reset Status Information */
;;;180      StatusInfo.w = 0;
;;;181    
;;;182      if (Type_Recipient == (STANDARD_REQUEST | DEVICE_RECIPIENT))
;;;183      {
;;;184        /*Get Device Status */
;;;185        uint8_t Feature = pInformation->Current_Feature;
;;;186    
;;;187        /* Remote Wakeup enabled */
;;;188        if (ValBit(Feature, 5))
;;;189        {
;;;190          SetBit(StatusInfo0, 1);
;;;191        }
;;;192        else
;;;193        {
;;;194          ClrBit(StatusInfo0, 1);
;;;195        }      
;;;196    
;;;197        /* Bus-powered */
;;;198        if (ValBit(Feature, 6))
;;;199        {
;;;200          SetBit(StatusInfo0, 0);
;;;201        }
;;;202        else /* Self-powered */
;;;203        {
;;;204          ClrBit(StatusInfo0, 0);
;;;205        }
;;;206      }
;;;207      /*Interface Status*/
;;;208      else if (Type_Recipient == (STANDARD_REQUEST | INTERFACE_RECIPIENT))
;;;209      {
;;;210        return (uint8_t *)&StatusInfo;
;;;211      }
;;;212      /*Get EndPoint Status*/
;;;213      else if (Type_Recipient == (STANDARD_REQUEST | ENDPOINT_RECIPIENT))
;;;214      {
;;;215        uint8_t Related_Endpoint;
;;;216        uint8_t wIndex0 = pInformation->USBwIndex0;
;;;217    
;;;218        Related_Endpoint = (wIndex0 & 0x0f);
;;;219        if (ValBit(wIndex0, 7))
;;;220        {
;;;221          /* IN endpoint */
;;;222          if (_GetTxStallStatus(Related_Endpoint))
;;;223          {
;;;224            SetBit(StatusInfo0, 0); /* IN Endpoint stalled */
;;;225          }
;;;226        }
;;;227        else
;;;228        {
;;;229          /* OUT endpoint */
;;;230          if (_GetRxStallStatus(Related_Endpoint))
;;;231          {
;;;232            SetBit(StatusInfo0, 0); /* OUT Endpoint stalled */
;;;233          }
;;;234        }
;;;235    
;;;236      }
;;;237      else
;;;238      {
;;;239        return NULL;
;;;240      }
;;;241      pUser_Standard_Requests->User_GetStatus();
;;;242      return (uint8_t *)&StatusInfo;
;;;243    }
000010  bd10              POP      {r4,pc}
                  |L15.18|
000012  2000              MOVS     r0,#0                 ;180
000014  4935              LDR      r1,|L15.236|
000016  8008              STRH     r0,[r1,#0]            ;180
000018  4833              LDR      r0,|L15.232|
00001a  6800              LDR      r0,[r0,#0]            ;182  ; pInformation
00001c  7800              LDRB     r0,[r0,#0]            ;182
00001e  f0100f7f          TST      r0,#0x7f              ;182
000022  d123              BNE      |L15.108|
000024  4930              LDR      r1,|L15.232|
000026  6809              LDR      r1,[r1,#0]            ;185  ; pInformation
000028  7a48              LDRB     r0,[r1,#9]            ;185
00002a  f0100f20          TST      r0,#0x20              ;188
00002e  d006              BEQ      |L15.62|
000030  492e              LDR      r1,|L15.236|
000032  7809              LDRB     r1,[r1,#0]            ;190  ; StatusInfo
000034  f0410102          ORR      r1,r1,#2              ;190
000038  4a2c              LDR      r2,|L15.236|
00003a  7011              STRB     r1,[r2,#0]            ;190
00003c  e005              B        |L15.74|
                  |L15.62|
00003e  492b              LDR      r1,|L15.236|
000040  7809              LDRB     r1,[r1,#0]            ;194  ; StatusInfo
000042  f00101fd          AND      r1,r1,#0xfd           ;194
000046  4a29              LDR      r2,|L15.236|
000048  7011              STRB     r1,[r2,#0]            ;194
                  |L15.74|
00004a  f0100f40          TST      r0,#0x40              ;198
00004e  d006              BEQ      |L15.94|
000050  4926              LDR      r1,|L15.236|
000052  7809              LDRB     r1,[r1,#0]            ;200  ; StatusInfo
000054  f0410101          ORR      r1,r1,#1              ;200
000058  4a24              LDR      r2,|L15.236|
00005a  7011              STRB     r1,[r2,#0]            ;200
00005c  e005              B        |L15.106|
                  |L15.94|
00005e  4923              LDR      r1,|L15.236|
000060  7809              LDRB     r1,[r1,#0]            ;204  ; StatusInfo
000062  f00101fe          AND      r1,r1,#0xfe           ;204
000066  4a21              LDR      r2,|L15.236|
000068  7011              STRB     r1,[r2,#0]            ;204
                  |L15.106|
00006a  e036              B        |L15.218|
                  |L15.108|
00006c  481e              LDR      r0,|L15.232|
00006e  6800              LDR      r0,[r0,#0]            ;208  ; pInformation
000070  7800              LDRB     r0,[r0,#0]            ;208
000072  f000007f          AND      r0,r0,#0x7f           ;208
000076  2801              CMP      r0,#1                 ;208
000078  d101              BNE      |L15.126|
00007a  481c              LDR      r0,|L15.236|
00007c  e7c8              B        |L15.16|
                  |L15.126|
00007e  481a              LDR      r0,|L15.232|
000080  6800              LDR      r0,[r0,#0]            ;213  ; pInformation
000082  7800              LDRB     r0,[r0,#0]            ;213
000084  f000007f          AND      r0,r0,#0x7f           ;213
000088  2802              CMP      r0,#2                 ;213
00008a  d124              BNE      |L15.214|
00008c  4a16              LDR      r2,|L15.232|
00008e  6812              LDR      r2,[r2,#0]            ;216  ; pInformation
000090  7951              LDRB     r1,[r2,#5]            ;216
000092  f001000f          AND      r0,r1,#0xf            ;218
000096  f0110f80          TST      r1,#0x80              ;219
00009a  d00d              BEQ      |L15.184|
00009c  4a14              LDR      r2,|L15.240|
00009e  f8522020          LDR      r2,[r2,r0,LSL #2]     ;222
0000a2  f0020230          AND      r2,r2,#0x30           ;222
0000a6  2a10              CMP      r2,#0x10              ;222
0000a8  d114              BNE      |L15.212|
0000aa  4a10              LDR      r2,|L15.236|
0000ac  7812              LDRB     r2,[r2,#0]            ;224  ; StatusInfo
0000ae  f0420201          ORR      r2,r2,#1              ;224
0000b2  4b0e              LDR      r3,|L15.236|
0000b4  701a              STRB     r2,[r3,#0]            ;224
0000b6  e00d              B        |L15.212|
                  |L15.184|
0000b8  4a0d              LDR      r2,|L15.240|
0000ba  f8522020          LDR      r2,[r2,r0,LSL #2]     ;230
0000be  f4025240          AND      r2,r2,#0x3000         ;230
0000c2  f5b25f80          CMP      r2,#0x1000            ;230
0000c6  d105              BNE      |L15.212|
0000c8  4a08              LDR      r2,|L15.236|
0000ca  7812              LDRB     r2,[r2,#0]            ;232  ; StatusInfo
0000cc  f0420201          ORR      r2,r2,#1              ;232
0000d0  4b06              LDR      r3,|L15.236|
0000d2  701a              STRB     r2,[r3,#0]            ;232
                  |L15.212|
0000d4  e001              B        |L15.218|
                  |L15.214|
0000d6  2000              MOVS     r0,#0                 ;239
0000d8  e79a              B        |L15.16|
                  |L15.218|
0000da  4906              LDR      r1,|L15.244|
0000dc  6809              LDR      r1,[r1,#0]            ;241  ; pUser_Standard_Requests
0000de  6908              LDR      r0,[r1,#0x10]         ;241
0000e0  4780              BLX      r0                    ;241
0000e2  4802              LDR      r0,|L15.236|
0000e4  e794              B        |L15.16|
;;;244    
                          ENDP

0000e6  0000              DCW      0x0000
                  |L15.232|
                          DCD      pInformation
                  |L15.236|
                          DCD      StatusInfo
                  |L15.240|
                          DCD      0x40005c00
                  |L15.244|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_SetConfiguration||, CODE, READONLY, ALIGN=2

                  Standard_SetConfiguration PROC
;;;89     *******************************************************************************/
;;;90     RESULT Standard_SetConfiguration(void)
000000  b510              PUSH     {r4,lr}
;;;91     {
;;;92     
;;;93       if ((pInformation->USBwValue0 <=
000002  480e              LDR      r0,|L16.60|
000004  6800              LDR      r0,[r0,#0]  ; pInformation
000006  78c0              LDRB     r0,[r0,#3]
000008  490d              LDR      r1,|L16.64|
00000a  7849              LDRB     r1,[r1,#1]  ; Device_Table
00000c  4288              CMP      r0,r1
00000e  dc13              BGT      |L16.56|
;;;94           Device_Table.Total_Configuration) && (pInformation->USBwValue1 == 0)
000010  480a              LDR      r0,|L16.60|
000012  6800              LDR      r0,[r0,#0]  ; pInformation
000014  7880              LDRB     r0,[r0,#2]
000016  b978              CBNZ     r0,|L16.56|
;;;95           && (pInformation->USBwIndex == 0)) /*call Back usb spec 2.0*/
000018  4808              LDR      r0,|L16.60|
00001a  6800              LDR      r0,[r0,#0]  ; pInformation
00001c  8880              LDRH     r0,[r0,#4]
00001e  b958              CBNZ     r0,|L16.56|
;;;96       {
;;;97         pInformation->Current_Configuration = pInformation->USBwValue0;
000020  4806              LDR      r0,|L16.60|
000022  6800              LDR      r0,[r0,#0]  ; pInformation
000024  78c0              LDRB     r0,[r0,#3]
000026  4905              LDR      r1,|L16.60|
000028  6809              LDR      r1,[r1,#0]  ; pInformation
00002a  7288              STRB     r0,[r1,#0xa]
;;;98         pUser_Standard_Requests->User_SetConfiguration();
00002c  4905              LDR      r1,|L16.68|
00002e  6809              LDR      r1,[r1,#0]  ; pUser_Standard_Requests
000030  6848              LDR      r0,[r1,#4]
000032  4780              BLX      r0
;;;99         return USB_SUCCESS;
000034  2000              MOVS     r0,#0
                  |L16.54|
;;;100      }
;;;101      else
;;;102      {
;;;103        return USB_UNSUPPORT;
;;;104      }
;;;105    }
000036  bd10              POP      {r4,pc}
                  |L16.56|
000038  2002              MOVS     r0,#2                 ;103
00003a  e7fc              B        |L16.54|
;;;106    
                          ENDP

                  |L16.60|
                          DCD      pInformation
                  |L16.64|
                          DCD      Device_Table
                  |L16.68|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_SetDeviceFeature||, CODE, READONLY, ALIGN=2

                  Standard_SetDeviceFeature PROC
;;;395    *******************************************************************************/
;;;396    RESULT Standard_SetDeviceFeature(void)
000000  b510              PUSH     {r4,lr}
;;;397    {
;;;398      SetBit(pInformation->Current_Feature, 5);
000002  4807              LDR      r0,|L17.32|
000004  6800              LDR      r0,[r0,#0]  ; pInformation
000006  7a40              LDRB     r0,[r0,#9]
000008  f0400020          ORR      r0,r0,#0x20
00000c  4904              LDR      r1,|L17.32|
00000e  6809              LDR      r1,[r1,#0]  ; pInformation
000010  7248              STRB     r0,[r1,#9]
;;;399      pUser_Standard_Requests->User_SetDeviceFeature();
000012  4904              LDR      r1,|L17.36|
000014  6809              LDR      r1,[r1,#0]  ; pUser_Standard_Requests
000016  69c8              LDR      r0,[r1,#0x1c]
000018  4780              BLX      r0
;;;400      return USB_SUCCESS;
00001a  2000              MOVS     r0,#0
;;;401    }
00001c  bd10              POP      {r4,pc}
;;;402    
                          ENDP

00001e  0000              DCW      0x0000
                  |L17.32|
                          DCD      pInformation
                  |L17.36|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_SetEndPointFeature||, CODE, READONLY, ALIGN=2

                  Standard_SetEndPointFeature PROC
;;;341    *******************************************************************************/
;;;342    RESULT Standard_SetEndPointFeature(void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;343    {
;;;344      uint32_t    wIndex0;
;;;345      uint32_t    Related_Endpoint;
;;;346      uint32_t    rEP;
;;;347      uint32_t    Status;
;;;348    
;;;349      wIndex0 = pInformation->USBwIndex0;
000004  4829              LDR      r0,|L18.172|
000006  6800              LDR      r0,[r0,#0]  ; pInformation
000008  7946              LDRB     r6,[r0,#5]
;;;350      rEP = wIndex0 & ~0x80;
00000a  f0260780          BIC      r7,r6,#0x80
;;;351      Related_Endpoint = ENDP0 + rEP;
00000e  463c              MOV      r4,r7
;;;352    
;;;353      if (ValBit(pInformation->USBwIndex0, 7))
000010  4826              LDR      r0,|L18.172|
000012  6800              LDR      r0,[r0,#0]  ; pInformation
000014  7940              LDRB     r0,[r0,#5]
000016  f0100f80          TST      r0,#0x80
00001a  d005              BEQ      |L18.40|
;;;354      {
;;;355        /* get Status of endpoint & stall the request if the related_ENdpoint
;;;356        is Disabled*/
;;;357        Status = _GetEPTxStatus(Related_Endpoint);
00001c  4824              LDR      r0,|L18.176|
00001e  f8500024          LDR      r0,[r0,r4,LSL #2]
000022  f0000530          AND      r5,r0,#0x30
000026  e004              B        |L18.50|
                  |L18.40|
;;;358      }
;;;359      else
;;;360      {
;;;361        Status = _GetEPRxStatus(Related_Endpoint);
000028  4821              LDR      r0,|L18.176|
00002a  f8500024          LDR      r0,[r0,r4,LSL #2]
00002e  f4005540          AND      r5,r0,#0x3000
                  |L18.50|
;;;362      }
;;;363    
;;;364      if (Related_Endpoint >= Device_Table.Total_Endpoint
000032  4820              LDR      r0,|L18.180|
000034  7800              LDRB     r0,[r0,#0]  ; Device_Table
000036  42a0              CMP      r0,r4
000038  d908              BLS      |L18.76|
;;;365          || pInformation->USBwValue != 0 || Status == 0
00003a  481c              LDR      r0,|L18.172|
00003c  6800              LDR      r0,[r0,#0]  ; pInformation
00003e  8840              LDRH     r0,[r0,#2]
000040  b920              CBNZ     r0,|L18.76|
000042  b11d              CBZ      r5,|L18.76|
;;;366          || pInformation->Current_Configuration == 0)
000044  4819              LDR      r0,|L18.172|
000046  6800              LDR      r0,[r0,#0]  ; pInformation
000048  7a80              LDRB     r0,[r0,#0xa]
00004a  b910              CBNZ     r0,|L18.82|
                  |L18.76|
;;;367      {
;;;368        return USB_UNSUPPORT;
00004c  2002              MOVS     r0,#2
                  |L18.78|
;;;369      }
;;;370      else
;;;371      {
;;;372        if (wIndex0 & 0x80)
;;;373        {
;;;374          /* IN endpoint */
;;;375          _SetEPTxStatus(Related_Endpoint, EP_TX_STALL);
;;;376        }
;;;377    
;;;378        else
;;;379        {
;;;380          /* OUT endpoint */
;;;381          _SetEPRxStatus(Related_Endpoint, EP_RX_STALL);
;;;382        }
;;;383      }
;;;384      pUser_Standard_Requests->User_SetEndPointFeature();
;;;385      return USB_SUCCESS;
;;;386    }
00004e  e8bd81f0          POP      {r4-r8,pc}
                  |L18.82|
000052  f0160f80          TST      r6,#0x80              ;372
000056  d011              BEQ      |L18.124|
000058  4915              LDR      r1,|L18.176|
00005a  f8511024          LDR      r1,[r1,r4,LSL #2]     ;375
00005e  b289              UXTH     r1,r1                 ;375
000060  f64872bf          MOV      r2,#0x8fbf            ;375
000064  ea010002          AND      r0,r1,r2              ;375
000068  f0800010          EOR      r0,r0,#0x10           ;375
00006c  f4404100          ORR      r1,r0,#0x8000         ;375
000070  f0410180          ORR      r1,r1,#0x80           ;375
000074  4a0e              LDR      r2,|L18.176|
000076  f8421024          STR      r1,[r2,r4,LSL #2]     ;375
00007a  e011              B        |L18.160|
                  |L18.124|
00007c  490c              LDR      r1,|L18.176|
00007e  f8511024          LDR      r1,[r1,r4,LSL #2]     ;381
000082  b289              UXTH     r1,r1                 ;381
000084  f64b728f          MOV      r2,#0xbf8f            ;381
000088  ea010002          AND      r0,r1,r2              ;381
00008c  f4805080          EOR      r0,r0,#0x1000         ;381
000090  f4404100          ORR      r1,r0,#0x8000         ;381
000094  f0410180          ORR      r1,r1,#0x80           ;381
000098  4a05              LDR      r2,|L18.176|
00009a  f8421024          STR      r1,[r2,r4,LSL #2]     ;381
00009e  bf00              NOP                            ;381
                  |L18.160|
0000a0  4905              LDR      r1,|L18.184|
0000a2  6809              LDR      r1,[r1,#0]            ;384  ; pUser_Standard_Requests
0000a4  6988              LDR      r0,[r1,#0x18]         ;384
0000a6  4780              BLX      r0                    ;384
0000a8  2000              MOVS     r0,#0                 ;385
0000aa  e7d0              B        |L18.78|
;;;387    
                          ENDP

                  |L18.172|
                          DCD      pInformation
                  |L18.176|
                          DCD      0x40005c00
                  |L18.180|
                          DCD      Device_Table
                  |L18.184|
                          DCD      pUser_Standard_Requests

                          AREA ||i.Standard_SetInterface||, CODE, READONLY, ALIGN=2

                  Standard_SetInterface PROC
;;;135    *******************************************************************************/
;;;136    RESULT Standard_SetInterface(void)
000000  b510              PUSH     {r4,lr}
;;;137    {
;;;138      RESULT Re;
;;;139      /*Test if the specified Interface and Alternate Setting are supported by
;;;140        the application Firmware*/
;;;141      Re = (*pProperty->Class_Get_Interface_Setting)(pInformation->USBwIndex0, pInformation->USBwValue0);
000002  4b17              LDR      r3,|L19.96|
000004  681b              LDR      r3,[r3,#0]  ; pInformation
000006  78d9              LDRB     r1,[r3,#3]
000008  4b15              LDR      r3,|L19.96|
00000a  681b              LDR      r3,[r3,#0]  ; pInformation
00000c  7958              LDRB     r0,[r3,#5]
00000e  4b15              LDR      r3,|L19.100|
000010  681b              LDR      r3,[r3,#0]  ; pProperty
000012  699a              LDR      r2,[r3,#0x18]
000014  4790              BLX      r2
000016  4604              MOV      r4,r0
;;;142    
;;;143      if (pInformation->Current_Configuration != 0)
000018  4811              LDR      r0,|L19.96|
00001a  6800              LDR      r0,[r0,#0]  ; pInformation
00001c  7a80              LDRB     r0,[r0,#0xa]
00001e  b1e8              CBZ      r0,|L19.92|
;;;144      {
;;;145        if ((Re != USB_SUCCESS) || (pInformation->USBwIndex1 != 0)
000020  b93c              CBNZ     r4,|L19.50|
000022  480f              LDR      r0,|L19.96|
000024  6800              LDR      r0,[r0,#0]  ; pInformation
000026  7900              LDRB     r0,[r0,#4]
000028  b918              CBNZ     r0,|L19.50|
;;;146            || (pInformation->USBwValue1 != 0))
00002a  480d              LDR      r0,|L19.96|
00002c  6800              LDR      r0,[r0,#0]  ; pInformation
00002e  7880              LDRB     r0,[r0,#2]
000030  b108              CBZ      r0,|L19.54|
                  |L19.50|
;;;147        {
;;;148          return  USB_UNSUPPORT;
000032  2002              MOVS     r0,#2
                  |L19.52|
;;;149        }
;;;150        else if (Re == USB_SUCCESS)
;;;151        {
;;;152          pUser_Standard_Requests->User_SetInterface();
;;;153          pInformation->Current_Interface = pInformation->USBwIndex0;
;;;154          pInformation->Current_AlternateSetting = pInformation->USBwValue0;
;;;155          return USB_SUCCESS;
;;;156        }
;;;157    
;;;158      }
;;;159    
;;;160      return USB_UNSUPPORT;
;;;161    }
000034  bd10              POP      {r4,pc}
                  |L19.54|
000036  b98c              CBNZ     r4,|L19.92|
000038  490b              LDR      r1,|L19.104|
00003a  6809              LDR      r1,[r1,#0]            ;152  ; pUser_Standard_Requests
00003c  68c8              LDR      r0,[r1,#0xc]          ;152
00003e  4780              BLX      r0                    ;152
000040  4807              LDR      r0,|L19.96|
000042  6800              LDR      r0,[r0,#0]            ;153  ; pInformation
000044  7940              LDRB     r0,[r0,#5]            ;153
000046  4906              LDR      r1,|L19.96|
000048  6809              LDR      r1,[r1,#0]            ;153  ; pInformation
00004a  72c8              STRB     r0,[r1,#0xb]          ;153
00004c  4804              LDR      r0,|L19.96|
00004e  6800              LDR      r0,[r0,#0]            ;154  ; pInformation
000050  78c0              LDRB     r0,[r0,#3]            ;154
000052  4903              LDR      r1,|L19.96|
000054  6809              LDR      r1,[r1,#0]            ;154  ; pInformation
000056  7308              STRB     r0,[r1,#0xc]          ;154
000058  2000              MOVS     r0,#0                 ;155
00005a  e7eb              B        |L19.52|
                  |L19.92|
00005c  2002              MOVS     r0,#2                 ;160
00005e  e7e9              B        |L19.52|
;;;162    
                          ENDP

                  |L19.96|
                          DCD      pInformation
                  |L19.100|
                          DCD      pProperty
                  |L19.104|
                          DCD      pUser_Standard_Requests

                          AREA ||.data||, DATA, ALIGN=1

                  Data_Mul_MaxPacketSize
000000  0000              DCB      0x00,0x00
                  StatusInfo
000002  0000              DCB      0x00,0x00
